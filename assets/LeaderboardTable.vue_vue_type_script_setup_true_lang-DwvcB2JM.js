import{d as M,u as S,r as w,b as v,U as T,e as j,o as s,c as r,a as l,y as b,t as d,k as h,h as u,i as $,F as y,q as P,j as L}from"./index-BXslawiU.js";import{s as V}from"./index-UVfE29m3.js";import{s as x}from"./ErrorBoundary.vue_vue_type_script_setup_true_lang-Cs-k4eCO.js";import{s as E}from"./index-BB79oU2T.js";import{I}from"./IconVignette-DQsJQqXm.js";const _=10,ie=M("leaderboard-store",()=>{const k=S(),c=w([]),t=w(!1),p=w(1);async function g(n){try{t.value=!0;const{data:i}=await T.getLeaderboard(n);c.value=i}catch(i){k.add({severity:"error",summary:i,life:2e3})}finally{t.value=!1}}const m=v(()=>c.value.find(n=>n.me)??null),e=v(()=>c.value.filter(n=>!n.me)),a=v(()=>Math.max(1,Math.ceil(e.value.length/_))),o=v(()=>{const n=(p.value-1)*_,i=e.value.slice(n,n+_);return m.value?[...i,m.value]:i}),f=v(()=>{const n=m.value,i=e.value;return n&&n.place<=7?[...i.slice(0,7),n].sort((B,A)=>B.place-A.place).slice(0,8):n?[...i.slice(0,7),n]:i.slice(0,7)});function C(n){p.value=Math.max(1,Math.min(n,a.value))}return{leaderboard:c,isLoading:t,loadLeaderboard:g,myEntry:m,otherEntries:e,paginatedEntries:o,homeEntries:f,currentPage:p,totalPages:a,goToPage:C}}),N={class:"w-10 h-10 shrink-0 flex items-center justify-center"},z={key:0,class:"relative flex justify-center items-center"},F={key:1,class:"text-body-small-semibold text-neutral800"},U={class:"flex flex-col min-w-0 flex-1"},q={class:"text-body-medium-semibold text-neutral800 truncate"},D={class:"action-small-regular text-neutral truncate"},G={class:"shrink-0 flex items-center gap-0.5"},R={class:"text-body-medium-semibold text-neutral800"},X=j({__name:"LeaderboardRow",props:{entry:{}},setup(k){const c={1:"text-warning400",2:"text-neutral",3:"text-warning700"};return(t,p)=>{var g;return s(),r("div",{class:b(["w-full h-14 flex items-center gap-4 p-2",t.entry.me?"bg-neutral50 rounded-lg":""])},[l("div",N,[t.entry.place<=3?(s(),r("div",z,[l("span",{class:b(["text-body-small-semibold pt-1 pb-3.5 pl-[15px] pr-3.5 z-10",c[t.entry.place]])},d(t.entry.place),3),h(u(I),{class:b(["absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[50%] w-10 h-10",c[t.entry.place]])},null,8,["class"])])):(s(),r("span",F,d(t.entry.place),1))]),t.entry.small_avatar_url?(s(),$(u(E),{key:0,image:t.entry.small_avatar_url,shape:"circle",class:"w-10 h-10 shrink-0",pt:{image:{class:"object-cover w-full h-full"}}},null,8,["image"])):(s(),$(u(E),{key:1,label:(g=t.entry.name)==null?void 0:g.charAt(0),shape:"circle",class:"w-10 h-10 shrink-0"},null,8,["label"])),l("div",U,[l("span",q,d(t.entry.name),1),l("span",D,d(t.entry.school_name),1)]),l("div",G,[l("span",R,d(t.entry.xp),1),p[0]||(p[0]=l("span",{class:"action-small-regular text-neutral"},"XP",-1))])],2)}}}),Z={class:"flex flex-col gap-6"},H={key:0,class:"flex flex-col"},J={class:"w-10 h-10 shrink-0 flex items-center justify-center"},K={class:"flex flex-col gap-1 flex-1 min-w-0"},O={class:"flex flex-col"},Q={key:0,class:"w-[369px] mx-auto flex items-center justify-between p-2 mt-2"},W=["disabled"],Y={key:0,class:"text-neutral text-body-small-semibold"},ee=["onClick"],te=["disabled"],se={key:2,class:"text-center py-12 text-neutral"},ce=j({__name:"LeaderboardTable",props:{entries:{},isLoading:{type:Boolean},showPagination:{type:Boolean,default:!1},currentPage:{default:1},totalPages:{default:1},skeletonCount:{default:10}},emits:["pageChange"],setup(k,{emit:c}){const t=k,p=c,g=v(()=>{if(!t.showPagination)return[];const e=t.totalPages,a=t.currentPage;return e<=5?Array.from({length:e},(o,f)=>f+1):a<=3?[1,2,3,4,"...",e]:a>=e-2?[1,"...",e-3,e-2,e-1,e]:[1,"...",a-1,a,a+1,"...",e]});function m(e){p("pageChange",e)}return(e,a)=>(s(),r("div",Z,[e.isLoading?(s(),r("div",H,[(s(!0),r(y,null,P(e.skeletonCount,o=>(s(),r("div",{key:o,class:"w-full h-14 flex items-center gap-4 p-2"},[l("div",J,[h(u(x),{width:"24px",height:"20px"})]),h(u(x),{shape:"circle",class:"!w-10 !h-10 shrink-0"}),l("div",K,[h(u(x),{height:"16px",class:"!w-3/4"}),h(u(x),{height:"12px",class:"!w-1/2"})]),h(u(x),{width:"60px",height:"20px",class:"shrink-0"})]))),128))])):e.entries.length>0?(s(),r(y,{key:1},[l("div",O,[(s(!0),r(y,null,P(e.entries,(o,f)=>(s(),r(y,{key:o.place},[f>0?(s(),$(u(V),{key:0,class:"!my-1"})):L("",!0),h(X,{entry:o},null,8,["entry"])],64))),128))]),e.showPagination&&e.totalPages>1?(s(),r("nav",Q,[l("button",{class:b(["flex items-center action-small-bold transition-colors gap-2 mr-8",e.currentPage<=1?"text-neutral300 cursor-not-allowed":"text-neutral hover:text-primary cursor-pointer"]),disabled:e.currentPage<=1,onClick:a[0]||(a[0]=o=>m(e.currentPage-1))},[a[2]||(a[2]=l("i",{class:"pi pi-chevron-left action-small-bold"},null,-1)),l("span",null,d(e.$t("previous")),1)],10,W),(s(!0),r(y,null,P(g.value,(o,f)=>(s(),r(y,{key:f},[o==="..."?(s(),r("span",Y,"...")):(s(),r("button",{key:1,class:b(["flex items-center justify-center text-body-small-semibold transition-colors cursor-pointer",o===e.currentPage?"text-primary":"text-neutral hover:text-primary"]),onClick:C=>m(o)},d(o),11,ee))],64))),128)),l("button",{class:b(["flex items-center action-small-bold transition-colors gap-2 ml-8",e.currentPage>=e.totalPages?"text-neutral300 cursor-not-allowed":"text-neutral hover:text-primary cursor-pointer"]),disabled:e.currentPage>=e.totalPages,onClick:a[1]||(a[1]=o=>m(e.currentPage+1))},[l("span",null,d(e.$t("next")),1),a[3]||(a[3]=l("i",{class:"pi pi-chevron-right action-small-bold"},null,-1))],10,te)])):L("",!0)],64)):(s(),r("div",se,d(e.$t("noLessonsAvailable")),1))]))}});export{ce as _,ie as u};
