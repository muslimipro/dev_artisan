import{s as P,a as O}from"./index-BxVfWoVs.js";import{s as U}from"./index-BbHqUexW.js";import{e as G,u as K,r as f,a5 as q,C as X,D as J,b as Q,o as c,c as u,a as s,i as R,j as D,y as W,k as m,w as r,G as S,t as i,h as j,F as Y,q as Z,K as tt,b2 as et}from"./index-BXslawiU.js";import{I as T}from"./IconVignette-DQsJQqXm.js";import{H as st}from"./hackathonApi-Cf0g46Qt.js";import{C as ot}from"./CountdownTimerStandings-2A_vyUfo.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-nahM27qd.js";import"./index-CGa94giF.js";import"./index-U6bxdMDU.js";import"./index-D-Li2oDx.js";import"./index-CG2VAMzt.js";import"./index-3ruNB34S.js";import"./index-ChaYh2fZ.js";import"./index-DBVaFmK0.js";import"./index-eWDnl5yI.js";import"./index-DrihGHDg.js";import"./index-D71fjEBX.js";import"./index-Dt3kwrS5.js";import"./index-Dz5hNrnF.js";import"./index-DkoQadpT.js";import"./index-D5RqcZfo.js";import"./index-C3n_x_8f.js";import"./LocaleSelectButton.vue_vue_type_script_setup_true_lang-DKeSLIQg.js";import"./index-CSI4_wiQ.js";import"./language-DYQF8nnT.js";import"./logo-D1-3uCnC.js";const nt={class:"flex flex-col items-center h-screen"},lt={class:"w-full max-w-[1280px] p-2 flex flex-col gap-2"},at={key:0,class:"z-50"},rt={class:"w-full flex text-heading-4-semibold text-neutral800 justify-center"},ct={class:"pb-2 flex w-full justify-center"},dt={key:0,class:"relative flex justify-center"},ft={class:"text-heading-4-semibold text-warning400"},ut={key:1,class:"relative flex justify-center"},mt={class:"text-heading-4-semibold text-neutral"},pt={key:2,class:"relative flex justify-center"},_t={class:"text-heading-4-semibold text-warning700"},xt={key:3,class:"text-heading-4-semibold flex justify-center"},vt={class:"flex text-heading-4-semibold text-neutral800"},ht={class:"flex flex-col justify-center"},yt={class:"text-heading-3-semibold text-neutral800"},gt={class:"text-body-medium-regular text-neutral"},wt={key:0,class:"flex gap-2 items-center"},bt={class:"text-overline-small text-primary400"},kt={key:1,class:"flex gap-2 items-center"},Dt={class:"text-overline-small text-error400"},jt={class:"flex w-full justify-center"},Tt={class:"text-center text-overline-small text-neutral800"},Nt={class:"flex flex-col items-center leading-tight"},zt={class:"font-medium"},Mt={class:"text-[10px] text-neutral400"},Ct={class:"flex w-full justify-center"},Ft={class:"text-center text-heading-4-semibold text-neutral800"},It={class:"flex flex-col items-center leading-tight"},$t={class:"flex justify-center font-bold"},Et={class:"flex justify-center text-[10px] text-neutral500"},Ht=G({__name:"HackathonStandings",setup(Rt){const B=K(),V=tt(),N=f(!1),z=f(!1),v=f([]),M=f([]),C=f({}),h=f(null),y=f(!1);async function F(){var a,n;N.value=!0;try{const{data:l}=await st.getHackathonResultsById(Number(V.params.id),z.value);y.value=l.frozen,l.name&&(h.value=l),l.lessons&&(v.value=l.lessons),l.students&&(M.value=l.students);const e={};for(const o of l.submits??[])e[o.team_id]||(e[o.team_id]={}),e[o.team_id][o.lesson_id]={points:o.points,created_at:o.created_at};C.value=e,z.value=!0}catch(l){B.add({severity:"error",summary:((n=(a=l.response)==null?void 0:a.data)==null?void 0:n.error)??"Error",detail:l.message,life:2e3})}finally{N.value=!1}}let g;q(F),X(()=>{g=window.setInterval(()=>{F()},15e3)}),J(()=>{g&&clearInterval(g)});const I={},x={},A=Q(()=>{const n=M.value.map(e=>{var p;const o={id:e.id,name:e.name,school_name:e.school_name};let t=0,d=null;for(const b of v.value){const _=(p=C.value[e.id])==null?void 0:p[b.id],E=(_==null?void 0:_.points)??0;o[b.id]=E;const k=(_==null?void 0:_.created_at)??null;if(o[`${b.id}_time`]=k,t+=E,k){const H=new Date(k).getTime();d=d===null?H:Math.max(d,H)}}return o.total=t,o.totalTime=d??Number.MAX_SAFE_INTEGER,o.lastFrozenDiff=x[e.id]||0,o}).sort((e,o)=>o.total!==e.total?o.total-e.total:e.totalTime-o.totalTime),l={};return n.forEach((e,o)=>{const t=o+1,d=I[e.id],p=d!==void 0?d-t:0;e.position=t,p!==0?(e.positionDiff=p,l[e.id]=p):e.positionDiff=0,I[e.id]=t}),Object.keys(x).forEach(e=>delete x[Number(e)]),Object.assign(x,l),n}),$=a=>{if(a==null)return"";const n=new Date(a);return isNaN(n.getTime())?"":n.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",second:"2-digit"})},L=f(),w=f();return(()=>{w.value={global:{value:null,matchMode:et.CONTAINS}}})(),(a,n)=>{const l=U,e=P,o=O;return c(),u("div",nt,[s("div",lt,[h.value?(c(),R(ot,{key:0,data:h.value},null,8,["data"])):D("",!0),s("div",{class:W(["flex flex-col gap-2 bg-white rounded-2xl p-4 relative",{"frozen-edge":y.value}])},[y.value?(c(),u("div",at,[m(l,{severity:"secondary",pt:{content:{class:"flex justify-center w-full"}}},{default:r(()=>[S(i(a.$t("frozen")),1)]),_:1})])):D("",!0),m(o,{ref_key:"dt",ref:L,filters:w.value,"onUpdate:filters":n[0]||(n[0]=t=>w.value=t),value:A.value,dataKey:"id",scrollable:"",class:"rounded-md overflow-hidden w-full"},{empty:r(()=>n[1]||(n[1]=[S(i("No data"))])),default:r(()=>[m(e,{field:"position"},{header:r(()=>[s("div",rt,i(a.$t("place")),1)]),body:r(({data:t})=>[s("div",ct,[t.position==1?(c(),u("div",dt,[s("div",ft,i(t.position),1),m(j(T),{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] w-10 h-10 text-warning400"})])):t.position==2?(c(),u("div",ut,[s("div",mt,i(t.position),1),m(j(T),{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] w-10 h-10 text-neutral"})])):t.position==3?(c(),u("div",pt,[s("div",_t,i(t.position),1),m(j(T),{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] w-10 h-10 text-warning700"})])):(c(),u("div",xt,i(t.position),1))])]),_:1}),m(e,{field:"name"},{header:r(()=>[s("div",vt,i(a.$t("team")),1)]),body:r(({data:t})=>[s("div",ht,[s("div",yt,i(t.name),1),s("div",gt,i(t.school_name),1)])]),_:1}),m(e,{field:"positionDiff"},{body:r(({data:t})=>[t.positionDiff>0?(c(),u("div",wt,[n[2]||(n[2]=s("i",{class:"pi pi-arrow-up text-primary400",style:{"font-size":"1rem"}},null,-1)),s("div",bt,i(Math.abs(t.positionDiff)),1)])):t.positionDiff<0?(c(),u("div",kt,[n[3]||(n[3]=s("i",{class:"pi pi-arrow-down text-error400",style:{"font-size":"1rem"}},null,-1)),s("div",Dt,i(Math.abs(t.positionDiff)),1)])):D("",!0)]),_:1}),(c(!0),u(Y,null,Z(v.value,t=>(c(),R(e,{key:t.id},{header:r(()=>[s("div",jt,[s("div",Tt,i(t.name),1)])]),body:r(({data:d})=>[s("div",Nt,[s("div",zt,i(d[t.id]),1),s("div",Mt,i($(d[`${t.id}_time`])),1)])]),_:2},1024))),128)),m(e,{field:"total",frozen:!0,alignFrozen:"right",class:"bg-neutral100"},{header:r(()=>[s("div",Ct,[s("div",Ft,i(a.$t("total")),1)])]),body:r(({data:t})=>[s("div",It,[s("div",$t,i(t.total),1),s("div",Et,i($(t.totalTime)),1)])]),_:1})]),_:1},8,["filters","value"])],2)])])}}}),fe=it(Ht,[["__scopeId","data-v-c23c9008"]]);export{fe as default};
