import{s as N}from"./index-CvjYr3FY.js";import{e as P,u as V,g as F,s as I,r as e,C as R,o as p,c as j,k as s,w as u,i as g,j as y,h as a,a as D,F as L,K as T,n as U,l as A}from"./index-8eYd0-Co.js";import{s as E}from"./index-DQafit8Y.js";import"./xlsx.min-BNDpkytq.js";import{S as h}from"./schoolApi-BwSNx1fk.js";import{m as K}from"./mapClassFromDto-BHXsJaNm.js";import{_ as M,a as O}from"./ExportProgressDialog.vue_vue_type_script_setup_true_lang-D4GQmZrq.js";import{_ as q}from"./SchoolInfo.vue_vue_type_script_setup_true_lang-TOlPYdMM.js";import"./index-ahqnJA0E.js";import"./index-fKBIE13H.js";import"./index-D24MRCgv.js";import"./index-DRGFISwW.js";import"./index-VgJXLjdG.js";import"./index-CQCkvxda.js";import"./index-B3NttIqY.js";import"./index-eKsVto-V.js";import"./index-CsjCzc3Q.js";import"./index-DW8h8G0I.js";import"./index-BB-HFA2F.js";import"./index-CSTKEaPu.js";import"./index-Drl6JR_B.js";import"./index-C5W94n6N.js";import"./index-H-9SRDzX.js";import"./index-c_rbGUP2.js";import"./index-DSx-p37b.js";import"./index-CrUX9qwQ.js";import"./xlsx-DjuO7_Ju.js";import"./routeApi-C9o8WR_b.js";import"./mapRouteFromDto-C1VVcbzq.js";import"./mapLessonFromDto-C9SLSKbW.js";import"./mapUnitFromDto-C-vlLM9s.js";import"./lessonType-DG-bLtoJ.js";import"./classApi-Cg8-sV8L.js";import"./mapStudentFromDto-D4MSietx.js";import"./index-CfMinl4z.js";import"./index-DXpPoTSi.js";const z={class:"flex gap-2"},Fo=P({__name:"SchoolOverviewPage",setup(G){const C=V(),d=T(),k=U(),x=F(),{userInfo:S}=I(x),i=e(!1),t=e(null);async function $(){try{i.value=!0;const{data:o}=await h.getSchoolById(Number(d.params.id));t.value=o}catch(o){console.log(o)}finally{i.value=!1}}const n=e([]),m=e(!1);async function w(){try{m.value=!0;const{data:o}=await h.getSchoolClassesById(Number(d.params.id));n.value=(o==null?void 0:o.map(K))??[]}catch(o){C.add({severity:"error",summary:o.response.data.error,life:2e3})}finally{m.value=!1}}R(()=>{$(),w()});const c=e(!1);return(o,r)=>{var v;const B=E,f=A,b=N;return p(),j(L,null,[s(b,{class:"flex-grow flex flex-col gap-2"},{default:u(()=>[i.value?(p(),g(B,{key:0,class:"flex justify-center"})):y("",!0),t.value?(p(),g(a(q),{key:1,school:t.value},null,8,["school"])):y("",!0),s(a(M),{classes:n.value,loading:m.value},{"header-extra":u(()=>[s(f,{label:o.$t("exportProgress"),icon:"pi pi-upload",severity:"info",variant:"outlined",class:"mr-2",onClick:r[0]||(r[0]=l=>c.value=!0)},null,8,["label"])]),actions:u(({row:l})=>[D("div",z,[s(f,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:H=>{var _;return a(k).push({name:["super_admin","admin-viewer"].includes(((_=a(S))==null?void 0:_.user_type)??"")?"admin-class":"supervisor-class",params:{id:l.id}})}},null,8,["onClick"])])]),_:1},8,["classes","loading"])]),_:1}),s(a(O),{"model-value":c.value,"onUpdate:modelValue":r[1]||(r[1]=l=>c.value=l),classes:n.value,"school-name":((v=t.value)==null?void 0:v.title_en)??""},null,8,["model-value","classes","school-name"])],64)}}});export{Fo as default};
