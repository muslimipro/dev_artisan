import{s as P}from"./index-C1N2nWcC.js";import{s as U}from"./index-BQKo0YUX.js";import{s as R}from"./index-BEGyIpqi.js";import{d as z,u as N,r as l,e as D,o as s,c as d,i,h as o,j as L,F as V,q as j,s as A,a5 as F,C as W,D as M,b as O,a,k as p,v as K,w as $,L as G,N as H,K as J,n as Q,l as X}from"./index-RQaPKU3q.js";import{u as Y,a as Z}from"./store-qJ2iV4r-.js";import{S as ee}from"./SimulationView-BfUuedT5.js";import"./IdeButtons.vue_vue_type_script_setup_true_lang-BoC8OHM6.js";import"./CodeEditorView.vue_vue_type_script_setup_true_lang-C1HaOUBK.js";import{_ as te}from"./CodeViewer.vue_vue_type_script_setup_true_lang-odlhIG4g.js";import{L as se}from"./lessonApi-CDtd4rn4.js";import{m as oe}from"./mapLessonFromDto-C2sH6sUU.js";import{m as ne}from"./mapUnitFromDto-DRcH-Z8v.js";import{U as ie}from"./unitApi-Y58tYEHm.js";import{_ as ae,a as re,b as le,c as ue}from"./TeacherReviseViewer.vue_vue_type_style_index_0_scoped_bad98aaa_lang-Cy-QTQYp.js";import"./MdViewer.vue_vue_type_style_index_0_lang-Bca--o1a.js";import{a as de,b as ce,_ as pe}from"./SubmitImageReviseViewer.vue_vue_type_script_setup_true_lang-BaZDqLr9.js";import"./index-CH_iu5NA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DZ_1xp5G.js";import"./index-DnxWnOWO.js";import"./index-i87uic1r.js";import"./index-5bJt7VTk.js";import"./index-DoQeMzHI.js";import"./transformUnitDtosToPages-BbPlv-Pt.js";import"./index-6V6lXQ4K.js";import"./index-CY8HVpGr.js";import"./index-3r_oBTLo.js";import"./index-C7IwSJ15.js";const me=z("lesson-revise-store",()=>{const g=N(),e=l(null),r=l(!1),u=l([]),h=l(null),k=l(null),m=l(!1),f=l(!1);async function C(v,y){m.value=!1,f.value=!1;try{r.value=!0;const{data:n}=await se.getLessonById(v,y);e.value=oe(n),await S()}catch(n){g.add({severity:"error",summary:n.response.data.error,life:2e3})}finally{r.value=!1}}async function S(){if(e.value)try{u.value=[];const v=[];e.value.pages.forEach(n=>{n.groups.forEach(w=>{w.units.forEach(b=>{v.push(b.id)})})});const{data:y}=await ie.getUnitsByIdsandLessonId(v,e.value.id);for(const n of y)u.value.push(ne(n)),(n.unit_type=="code"||n.unit_type=="pibody")&&(m.value=!0,k.value=Y("emulatorID"),k.value.setCode("")),n.unit_type=="pibody"&&(f.value=!0,h.value=Z("emulatorID"),h.value.addNeededModules([]))}catch(v){console.error("Error loading units:",v)}finally{}}return{selectedLesson:e,isLessonLoading:r,units:u,showPibody:f,showCode:m,loadLessonById:C}}),fe={key:1,class:"flex-grow px-4 py-2"},ve=D({__name:"UnitCard",props:{unit:{},loading:{type:Boolean}},setup(g){const e=g;return(r,u)=>{const h=U;return s(),d("div",null,[r.loading?(s(),i(h,{key:0,class:"flex justify-center items-center w-10 h-full"})):(s(),d("div",fe,[e.unit.unitType=="article"?(s(),i(o(ae),{key:0,article:e.unit.content},null,8,["article"])):e.unit.unitType=="options"?(s(),i(o(re),{key:1,"options-data":e.unit.content,state:e.unit.studentState},null,8,["options-data","state"])):e.unit.unitType=="open"?(s(),i(o(le),{key:2,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="video"?(s(),i(o(ue),{key:3,video:e.unit.content},null,8,["video"])):e.unit.unitType=="code"?(s(),i(o(de),{key:4,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="pibody"?(s(),i(o(ce),{key:5,state:e.unit.studentState},null,8,["state"])):e.unit.unitType=="submit-image"?(s(),i(o(pe),{key:6,state:e.unit.studentState},null,8,["state"])):L("",!0)]))])}}}),ye={ref:"rootEl",class:"flex flex-col gap-8"},_e=D({__name:"UnitsView",props:{units:{}},setup(g){return(e,r)=>(s(),d("div",ye,[(s(!0),d(V,null,j(e.units,u=>(s(),i(ve,{key:u.id,unit:u},null,8,["unit"]))),128))],512))}}),he={class:"h-screen flex flex-col items-center overflow-hidden relative bg-white"},we={class:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 max-w-[1920px] mx-auto"},be={class:"flex justify-between items-center w-full min-h-16 px-8 gap-8"},ge={class:"flex items-center gap-4"},xe={key:0,class:"flex flex-grow max-w-screen-lg items-center gap-4"},ke={class:"flex-1 overflow-y-auto mt-16 mb-0 w-full"},$e={key:1,class:"flex justify-center"},Le={key:2},Ce={key:0,class:"absolute left-0 top-1/2 -translate-y-1/2"},Se={class:"relative h-full"},Be={class:"absolute -right-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},De={key:1,class:"absolute right-0 top-1/2 -translate-y-1/2"},Ee={class:"relative h-full"},Ie={class:"absolute -left-0 top-1/2 -translate-y-1/2 w-5 h-10 z-10"},at=D({__name:"LessonRevisePage",setup(g){const e=J(),r=Q(),u=me(),{units:h,isLessonLoading:k,selectedLesson:m,showPibody:f,showCode:C}=A(u),{loadLessonById:S}=u;function v(){var _;((_=m.value)==null?void 0:_.lessonType)=="module"?r.push("/v2/docs"):e.query.route_id&&e.query.route_id!=""?r.push("/v2/route/"+e.query.route_id):r.push("/v2/home")}const y=l(window.innerWidth),n=l(16),w=l(!0),b=l(!0);function B(){if(y.value=window.innerWidth,y.value<=1300){n.value=16;return}const t=452-(y.value-1024)/2;n.value=t>16?t:16}F(async()=>{var _;await S(Number(e.params.id),(e.query.route_id??"").toString()),e.query.route_id=="10"&&((_=m.value)==null?void 0:_.lessonType)!="learn"&&r.push({path:e.path.replace("/lesson/","/lesson-blocks/").replace("/revise",""),query:e.query})}),W(()=>{B(),window.addEventListener("resize",B)}),M(()=>{window.removeEventListener("resize",B)});const E=O(()=>y.value<=1920?{}:"calc((-100vw + 1920px) / 2)");return(_,t)=>{const x=X,T=R,q=U,I=P;return s(),d("div",he,[a("div",we,[a("div",be,[a("div",ge,[p(x,{icon:"pi pi-times",variant:"text",severity:"contrast",onClick:v})]),o(m)?(s(),d("div",xe,[p(T,{value:100,"show-value":!1,class:"w-full rounded-full h-3"})])):L("",!0),t[7]||(t[7]=a("div",{class:"w-10"},null,-1))])]),a("div",ke,[a("div",{class:"w-full h-full max-w-screen-lg mx-auto py-8",style:K({paddingLeft:n.value+"px",paddingRight:n.value+"px"})},[o(k)?(s(),i(q,{key:0,class:"flex justify-center"})):o(m)?(s(),d("div",Le,[p(_e,{units:o(h)},null,8,["units"])])):(s(),d("div",$e,"No lesson found"))],4)]),o(f)?(s(),d("div",Ce,[p(x,{icon:"pi pi-microchip",severity:"secondary",onClick:t[0]||(t[0]=c=>w.value=!0),class:"w-8 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg mt-16"}),p(I,{visible:w.value,"onUpdate:visible":t[2]||(t[2]=c=>w.value=c),modal:!1,dismissable:!1,closeOnEscape:!1,class:"h-[calc(100vh-64px)] w-fit mt-16",pt:{root:{style:`right: ${E.value}`}}},{header:$(()=>t[8]||(t[8]=[a("div",null,null,-1)])),container:$(()=>[a("div",Se,[a("div",Be,[p(x,{icon:"pi pi-chevron-left",severity:"secondary",onClick:t[1]||(t[1]=c=>w.value=!1),class:"w-5 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none"})]),(s(),i(o(ee),{id:"emulatorID",key:"emulatorID",class:"w-full",horizontal:!1,autoPut:!0}))])]),_:1},8,["visible","pt"])])):L("",!0),o(C)?(s(),d("div",De,[p(x,{icon:"pi pi-code",severity:"secondary",onClick:t[3]||(t[3]=c=>b.value=!0),class:"w-8 rounded-tl-lg rounded-bl-lg rounded-tr-none rounded-br-none mt-16"}),p(I,{visible:b.value,"onUpdate:visible":t[6]||(t[6]=c=>b.value=c),header:"Drawer",modal:!1,dismissable:!1,closeOnEscape:!1,position:"right",class:"h-[calc(100vh-64px)] w-[452px] mt-16",pt:{root:{style:`left: ${E.value}`}}},{header:$(()=>t[9]||(t[9]=[a("div",null,null,-1)])),container:$(()=>[a("div",Ee,[a("div",Ie,[p(x,{icon:"pi pi-chevron-right",severity:"secondary",onClick:t[4]||(t[4]=c=>b.value=!1),class:"w-5 rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg"})]),(s(),i(H,null,[(s(),i(o(te),{id:"emulatorID",key:"emulatorID",connectbuttons:o(f),"onUpdate:connectbuttons":t[5]||(t[5]=c=>G(f)?f.value=c:null)},null,8,["connectbuttons"]))],1024))])]),_:1},8,["visible","pt"])])):L("",!0)])}}});export{at as default};
