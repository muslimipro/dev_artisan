import{$ as R,e as P,f as J,u as K,r,b as O,o as d,c as h,a as e,k as t,h as w,G as g,w as p,i as k,j as C,t as n,T as Q,F as X,n as Y,l as Z,R as ee}from"./index-RQaPKU3q.js";import{s as se}from"./index-DYe12pIs.js";import{h as ae,z as $,s as le}from"./index-zUgF_fUw.js";import{s as te}from"./index-CmgTJnJ7.js";import{s as ie}from"./index-DoQeMzHI.js";import{s as oe}from"./index-i87uic1r.js";import{_ as ne}from"./LocaleSelectButton.vue_vue_type_script_setup_true_lang-D5A7GxOk.js";import{L as re}from"./logo-D1-3uCnC.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-5bJt7VTk.js";import"./index-csPL02fk.js";import"./language-DYQF8nnT.js";const N={checkActivation:ce,createSchoolByCode:ue};async function ce(y){try{return await R.post("/v2/activation/check",null,{params:{code:y}})}catch(a){throw console.log(a),a}}async function ue(y,a,u,S,c){return await R.post("/v2/school/register",{code:y,title:a,address:u,email:S,force_type_change:c,country:""})}const me={class:"h-screen bg-white flex flex-col overflow-hidden relative"},ve={class:"w-full h-full flex justify-center gap-6 max-w-[1440px] p-6 mx-auto"},ge={class:"hidden lg:flex flex-col w-full max-w-[684px] justify-between bg-primary rounded-2xl p-10"},pe={class:"flex items-center gap-2"},fe={class:"w-full max-w-[684px] mx-auto flex items-center justify-center relative overflow-hidden"},he={class:"flex gap-1"},ye={class:"text-heading-3-semibold mb-2"},_e={class:"text-body-large-regular mb-8"},be={key:0,class:"w-full"},xe={class:"text-body-medium-regular mb-1"},we={key:1},ke={class:"text-body-medium-regular mb-1"},Ce={class:"mb-6"},$e={class:"text-body-medium-regular mb-1"},Se={class:"mb-6"},Ie={class:"text-body-medium-regular mb-1"},Ve={class:"mb-6"},Ae={key:2},Te={class:"flex flex-col gap-1"},Be={class:"flex justify-center text-body-medium-regular"},je={class:"flex gap-2 justify-end"},Le=P({__name:"SchoolSignup",setup(y){const{t:a}=J(),u=K(),S=Y(),c=r(!1),V=r(!1),_=r(""),A=r(!1),m=r(!1);async function z(){c.value=!0;try{const{data:s}=await N.checkActivation(_.value);V.value=s.is_valid,V.value?(u.add({severity:"success",summary:a("pages.login.codeIsValid"),life:2e3}),T()):u.add({severity:"error",summary:a("pages.login.codeIsInvalid"),life:2e3})}catch(s){u.add({severity:"error",summary:s,life:2e3})}finally{c.value=!1}}const o=r(0),b=O(()=>[{id:0,title:a("pages.login.enterActivationCode"),description:a("pages.login.weWillVerifyActivationCode")},{id:1,title:a("pages.login.enterSchoolInfo"),description:a("pages.login.pleaseProvideInfo")},{id:2,title:a("pages.login.registrationSuccess"),description:a("pages.login.weHaveSentLoginDetails")}]);function T(){o.value<b.value.length-1&&o.value++}const f=r(!1),F=r({name:"",address:"",email:""}),q=ae($.object({name:$.string().min(1,{message:a("pages.login.nameIsRequired")}).max(100,{message:a("pages.login.max100chars")}),address:$.string().min(1,{message:a("pages.login.addressIsRequired")}).max(100,{message:a("pages.login.max100chars")}),email:$.string().email({message:a("pages.settings.emailInvalid")}).min(1,{message:a("pages.login.emailIsRequired")}).max(100,{message:a("pages.login.max100chars")})})),E=async s=>{if(!f.value&&s.valid){f.value=!0;try{await N.createSchoolByCode(_.value,s.states.name.value,s.states.address.value,s.states.email.value,A.value),T()}catch(l){l.status==409&&!m.value?m.value=!0:u.add({severity:"error",summary:l.response.data.error,life:3e3})}finally{f.value=!1}}},B=r(null);async function M(){var s;A.value=!0,m.value=!1,await((s=B.value)==null?void 0:s.submit())}return(s,l)=>{const U=oe,v=Z,x=ie,I=te,W=le,G=se,H=ee;return d(),h(X,null,[e("div",me,[e("div",ve,[e("div",ge,[e("div",pe,[t(U,{src:w(re),width:"40"},null,8,["src"]),l[5]||(l[5]=e("p",{class:"text-heading-2-bold text-black"},"Artisan",-1))]),l[6]||(l[6]=e("div",{class:"text-display-small-bold text-neutral900"},[g(" Building"),e("br"),e("span",{class:"text-white"},"creative"),e("br"),g(" learners who"),e("br"),g(" love to grow ")],-1))]),e("div",fe,[t(w(ne),{class:"absolute top-0 left-1/2 -translate-x-1/2"}),t(Q,{name:"slide-fade",mode:"out-in",class:"w-full max-w-[540px] flex"},{default:p(()=>[(d(),h("div",{key:o.value,class:"w-full flex flex-col"},[e("div",he,[o.value>0&&o.value!=b.value.length-1?(d(),k(v,{key:0,icon:"pi pi-chevron-left",class:"h-6 w-6",severity:"secondary",variant:"text",onClick:l[0]||(l[0]=i=>o.value--)})):C("",!0),e("div",ye,n(b.value[o.value].title),1)]),e("div",_e,n(b.value[o.value].description),1),o.value===0?(d(),h("div",be,[e("div",xe,n(s.$t("pages.login.activationCode")),1),t(x,{modelValue:_.value,"onUpdate:modelValue":l[1]||(l[1]=i=>_.value=i),type:"text",fluid:"",class:"mb-6"},null,8,["modelValue"]),t(v,{label:s.$t("pages.login.continue"),class:"w-full h-12",onClick:z,loading:c.value,disabled:c.value},null,8,["label","loading","disabled"])])):o.value===1?(d(),h("div",we,[t(W,{ref_key:"form",ref:B,initialValues:F.value,resolver:w(q),onSubmit:E},{default:p(i=>{var j,L,D;return[e("div",ke,n(s.$t("pages.login.schoolName")),1),e("div",Ce,[t(x,{id:"name",name:"name",type:"text",fluid:""}),(j=i.name)!=null&&j.invalid?(d(),k(I,{key:0,severity:"error",size:"small",variant:"simple"},{default:p(()=>[g(n(i.name.error.message),1)]),_:2},1024)):C("",!0)]),e("div",$e,n(s.$t("pages.login.schoolAddress")),1),e("div",Se,[t(x,{id:"address",name:"address",type:"text",fluid:""}),(L=i.address)!=null&&L.invalid?(d(),k(I,{key:0,severity:"error",size:"small",variant:"simple"},{default:p(()=>[g(n(i.address.error.message),1)]),_:2},1024)):C("",!0)]),e("div",Ie,n(s.$t("pages.login.schoolEmail")),1),e("div",Ve,[t(x,{id:"email",name:"email",type:"text",fluid:""}),(D=i.email)!=null&&D.invalid?(d(),k(I,{key:0,severity:"error",size:"small",variant:"simple"},{default:p(()=>[g(n(i.email.error.message),1)]),_:2},1024)):C("",!0)]),t(v,{label:s.$t("pages.login.registerSchool"),type:"submit",class:"w-full h-12",loading:f.value,disabled:f.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])])):(d(),h("div",Ae,[t(v,{label:s.$t("pages.login.goToLogin"),class:"w-full h-12",onClick:l[2]||(l[2]=i=>w(S).replace({name:"login"})),loading:c.value,disabled:c.value},null,8,["label","loading","disabled"])]))]))]),_:1})])])]),t(H,{visible:m.value,"onUpdate:visible":l[4]||(l[4]=i=>m.value=i),modal:"",header:s.$t("accountTypeChange"),class:"m-4 max-w-md"},{default:p(()=>[e("div",Te,[e("div",Be,n(s.$t("thisAccountAlreadyExistsAndWillBeChangedToSchoolManager")),1)]),t(G),e("div",je,[t(v,{label:s.$t("pages.teacher.cancel"),severity:"secondary",onClick:l[3]||(l[3]=i=>m.value=!1)},null,8,["label"]),t(v,{label:s.$t("continue"),type:"submit",onClick:M},null,8,["label"])])]),_:1},8,["visible","header"])],64)}}}),Pe=de(Le,[["__scopeId","data-v-85f4e45c"]]);export{Pe as default};
