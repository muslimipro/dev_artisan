import{T as q}from"./index-CID063JX.js";import{h as F,z as B,s as H}from"./index-v1ivQW6n.js";import{e as C,P as Y,u as U,J as G,s as D,r as m,D as J,o as i,i as _,w as v,a as l,k as f,G as N,t as p,j,h as c,U as z,ag as L,l as M,R as K,f as O,g as Q,c as I,H as W}from"./index-8eYd0-Co.js";import{s as R}from"./index-19jCyGXe.js";import{s as X}from"./index-B3NttIqY.js";const Z={class:"text-blue-500"},ee={class:"flex flex-col gap-1"},se={class:"flex gap-1 justify-end"},ae=C({__name:"VerifyEmailDialog",props:{modelValue:{type:Boolean,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(w){const u=Y(w,"modelValue"),g=U(),x=G(),{user:n}=D(x),o=m(!1),e=m(0);let r;const $=()=>{e.value=60,r=setInterval(()=>{e.value>0?e.value--:clearInterval(r)},1e3)};async function V(){o.value=!0;try{const{data:t}=await z.sendVerificationEmail();g.add({severity:"success",summary:t.message,life:2e3}),$()}catch(t){g.add({severity:"error",summary:t.response.data.error,detail:t,life:2e3})}finally{o.value=!1}}return J(()=>{clearInterval(r)}),(t,y)=>{const s=L("i18n-t"),a=M,b=R,k=K;return i(),_(k,{visible:u.value,"onUpdate:visible":y[0]||(y[0]=d=>u.value=d),modal:"",draggable:!1,class:"m-4 max-w-md",header:t.$t("dialog.verifyYourEmail")},{footer:v(()=>[l("div",ee,[l("div",se,[f(a,{label:e.value>0?`${t.$t("pages.login.resendIn")} ${e.value}s`:t.$t("dialog.sendVerificationEmail"),onClick:V,loading:o.value,disabled:o.value||e.value>0},null,8,["label","loading","disabled"])]),e.value>0?(i(),_(b,{key:0,severity:"success"},{default:v(()=>[N(p(t.$t("pages.settings.weHaveSentLinkToVerifyEmail")),1)]),_:1})):j("",!0)])]),default:v(()=>[l("div",null,[f(s,{keypath:"dialog.confirmEmailAddress"},{email:v(()=>{var d;return[l("span",Z,p((d=c(n))==null?void 0:d.email),1)]}),_:1})])]),_:1},8,["visible","header"])}}}),le={class:"p-6 bg-white rounded-2xl"},te={key:0},oe={class:"text-heading-3-bold text-neutral900"},ie={class:"flex flex-col gap-6"},ne={class:"flex flex-col gap-1"},re={class:"text-body-medium-regular text-neutral900"},de={class:"flex flex-col gap-1"},ue={class:"text-body-medium-regular text-neutral400"},ce={class:"flex gap-6 items-center"},me={key:1,class:"p-1 bg-primary h-6 w-6 rounded-full flex items-center justify-center"},_e=C({__name:"PersonalInfoPage",setup(w){var y;const{t:u}=O(),g=U(),x=Q(),{userInfo:n}=D(x),o=m(!1),e=m(!1),r=m(!1),$=m({name:((y=n.value)==null?void 0:y.name)??""}),V=F(B.object({name:B.string().min(1,{message:u("pages.login.nameIsRequired")}).max(100,{message:u("pages.login.max100chars")})})),t=async s=>{if(!(e.value||!s.valid)){e.value=!0;try{await z.updateUserInfo({name:s.states.name.value}),g.add({severity:"success",summary:u("pages.settings.successfullySaved"),life:2e3}),r.value=!1}catch(a){g.add({severity:"error",summary:a.response.data.error,life:3e3})}finally{e.value=!1}}};return(s,a)=>{const b=X,k=R,d=M,A=H,P=q;return i(),I("div",le,[c(n)?(i(),_(A,{key:1,initialValues:$.value,resolver:c(V),onSubmit:t,class:"flex flex-col gap-10"},{default:v(h=>{var E;return[l("div",oe,p(s.$t("personalInfo")),1),l("div",ie,[l("div",ne,[l("div",re,p(s.$t("pages.settings.name")),1),f(b,{name:"name",type:"text",fluid:"",placeholder:s.$t("pages.settings.name"),onInput:a[0]||(a[0]=S=>{var T;return r.value=S.target.value!==(((T=c(n))==null?void 0:T.name)??"")})},null,8,["placeholder"]),(E=h.name)!=null&&E.invalid?(i(),_(k,{key:0,severity:"error",size:"small",variant:"simple"},{default:v(()=>[N(p(h.name.error.message),1)]),_:2},1024)):j("",!0)]),l("div",de,[l("div",ue,p(s.$t("email")),1),l("div",ce,[f(b,{value:c(n).email,type:"text",fluid:"",placeholder:s.$t("email"),disabled:"",class:"flex-1"},null,8,["value","placeholder"]),c(n).verified?W((i(),I("div",me,a[3]||(a[3]=[l("i",{class:"pi pi-check text-white",style:{"font-size":"0.75rem"}},null,-1)]))),[[P,s.$t("pages.settings.verified")]]):(i(),_(d,{key:0,label:s.$t("dialog.verifyYourEmail"),severity:"warn",variant:"outlined",class:"flex-1",onClick:a[1]||(a[1]=S=>o.value=!0)},null,8,["label"]))])])]),f(d,{type:"submit",label:s.$t("saveChanges"),size:"small",class:"w-fit self-end",disabled:e.value||!r.value,loading:e.value},null,8,["label","disabled","loading"])]}),_:1},8,["initialValues","resolver"])):(i(),I("div",te,"No user")),f(ae,{modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=h=>o.value=h)},null,8,["modelValue"])])}}});export{_e as default};
