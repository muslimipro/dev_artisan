import{h as N,z as m,s as C}from"./index-v1ivQW6n.js";import{e as H,f as M,u as S,r as v,o as l,c as r,k as c,w as g,a as t,t as n,i as w,F as x,q as y,j as h,h as U,U as j,l as q}from"./index-8eYd0-Co.js";import{s as A}from"./index-19jCyGXe.js";import{s as L}from"./index-B3NttIqY.js";const T={class:"p-6 bg-white rounded-2xl"},D={class:"text-heading-3-bold text-neutral900"},E={class:"flex flex-col gap-6"},R={class:"flex flex-col gap-1"},Z={class:"text-body-medium-regular text-neutral900"},G={class:"my-0 flex flex-col gap-1"},J={class:"flex flex-col gap-1"},K={class:"text-body-medium-regular text-neutral900"},O={class:"my-0 flex flex-col gap-1"},Q={class:"flex flex-col gap-1"},W={class:"text-body-medium-regular text-neutral900"},X={class:"my-0 flex flex-col gap-1"},le=H({__name:"PasswordPage",setup(Y){const{t:o}=M(),b=S(),d=v(!1),p=v(!1),V=v({old_password:"",new_password:""}),$=N(m.object({old_password:m.string().min(1,{message:o("pages.login.oldPassRequired")}).max(100,{message:o("pages.login.max100chars")}),new_password:m.string().min(8,{message:o("pages.login.min8chars")}).max(100,{message:o("pages.login.max100chars")}).refine(e=>/[a-z]/.test(e),{message:o("pages.login.mustHaveLowercase")}).refine(e=>/[A-Z]/.test(e),{message:o("pages.login.mustHaveUppercase")}).refine(e=>/[0-9]/.test(e),{message:o("pages.login.mustHaveNumber")}),confirm_password:m.string()}).refine(e=>e.new_password===e.confirm_password,{message:o("pages.login.passMustMatch"),path:["confirm_password"]})),B=async e=>{if(!(d.value||!e.valid)){d.value=!0;try{const{data:s}=await j.changePassword(e.states.old_password.value,e.states.new_password.value);b.add({severity:"success",summary:s.message,life:2e3}),p.value=!1}catch(s){b.add({severity:"error",summary:s.response.data.error,detail:s,life:2e3})}finally{d.value=!1}}};return(e,s)=>{const f=L,_=A,I=q,F=C;return l(),r("div",T,[c(F,{initialValues:V.value,resolver:U($),onSubmit:B,class:"flex flex-col gap-10"},{default:g(i=>{var P,k,z;return[t("div",D,n(e.$t("password")),1),t("div",E,[t("div",R,[t("div",Z,n(e.$t("pages.settings.oldPassword")),1),c(f,{name:"old_password",type:"text",fluid:"",placeholder:e.$t("pages.settings.oldPassword"),onInput:s[0]||(s[0]=a=>p.value=a.target.value=!0)},null,8,["placeholder"]),(P=i.old_password)!=null&&P.invalid?(l(),w(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:g(()=>[t("ul",G,[(l(!0),r(x,null,y(i.old_password.errors,(a,u)=>(l(),r("li",{key:u},n(a.message),1))),128))])]),_:2},1024)):h("",!0)]),t("div",J,[t("div",K,n(e.$t("pages.settings.newPassword")),1),c(f,{name:"new_password",type:"text",fluid:"",placeholder:e.$t("pages.settings.newPassword"),onInput:s[1]||(s[1]=a=>p.value=a.target.value=!0)},null,8,["placeholder"]),(k=i.new_password)!=null&&k.invalid?(l(),w(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:g(()=>[t("ul",O,[(l(!0),r(x,null,y(i.new_password.errors,(a,u)=>(l(),r("li",{key:u},n(a.message),1))),128))])]),_:2},1024)):h("",!0)]),t("div",Q,[t("div",W,n(e.$t("pages.settings.confirmPassword")),1),c(f,{name:"confirm_password",type:"text",fluid:"",placeholder:e.$t("pages.settings.confirmPassword"),onInput:s[2]||(s[2]=a=>p.value=a.target.value=!0)},null,8,["placeholder"]),(z=i.confirm_password)!=null&&z.invalid?(l(),w(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:g(()=>[t("ul",X,[(l(!0),r(x,null,y(i.confirm_password.errors,(a,u)=>(l(),r("li",{key:u},n(a.message),1))),128))])]),_:2},1024)):h("",!0)])]),c(I,{type:"submit",label:e.$t("pages.settings.savePassword"),size:"small",class:"w-fit self-end",disabled:d.value||!p.value,loading:d.value},null,8,["label","disabled","loading"])]}),_:1},8,["initialValues","resolver"])])}}});export{le as default};
