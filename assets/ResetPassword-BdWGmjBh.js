import{z as R,a as d,s as S}from"./index-DkOlpifc.js";import{s as $}from"./index-BBoKg6kX.js";import{s as j}from"./index-BSYBl58h.js";import{s as L}from"./index-D25-dpJK.js";import{d as E,u as q,r as k,o,c as i,b as r,e,j as h,w as n,f as M,F as p,i as z,t as u,h as P,l as A,k as D,s as T}from"./index-D-EZhA5_.js";import{_ as Z}from"./AuthHeader.vue_vue_type_script_setup_true_lang-Dnbp8k7t.js";import{a as G}from"./index-Dtx9JcMJ.js";import"./logo-BAnqdCyc.js";import"./index-Dknz9p_q.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-aUOpbhzU.js";import"./index-Bayqa3ID.js";const H={class:"card flex flex-col items-center pt-4"},I={class:"flex flex-col gap-1"},J={class:"my-0 flex flex-col gap-1"},K={class:"flex flex-col gap-1"},O={for:"confirm_password"},Q={class:"my-0 flex flex-col gap-1"},ns=E({__name:"ResetPassword",setup(U){const f=q(),B=A(),_=D(),t=k(!1),V=k({password:""}),F=R(d.object({password:d.string().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:d.string()}).refine(s=>s.password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),N=async s=>{if(!t.value&&s.valid){t.value=!0;try{await G.resetPassword(B.query.token,s.states.password.value),_.replace({name:"login"}),f.add({severity:"success",summary:"Password changed successfully",life:3e3})}catch(a){console.log(a),f.add({severity:"error",summary:"Expired or invalid token",life:3e3})}finally{t.value=!1}}};return(s,a)=>{const w=T,v=L,g=j,x=$,C=S;return o(),i(p,null,[r(Z),e("div",H,[r(w,{label:"Back to Login",variant:"outlined",icon:"pi pi-arrow-left",size:"small",onClick:a[0]||(a[0]=l=>h(_).replace({name:"login"}))}),r(C,{initialValues:V.value,resolver:h(F),onSubmit:N,class:"flex flex-col gap-4 w-full sm:w-80 sm:px-0 px-8"},{default:n(l=>{var y,b;return[a[2]||(a[2]=e("div",{class:"flex flex-1 items-center justify-center my-4"},[e("p",{class:"text-4xl font-semibold px-2 mr-4"},"New Password")],-1)),e("div",I,[r(g,{variant:"on"},{default:n(()=>[r(v,{id:"password",name:"password",feedback:!1,toggleMask:"",fluid:""}),a[1]||(a[1]=e("label",{for:"password"},"New password",-1))]),_:1}),(y=l.password)!=null&&y.invalid?(o(),M(x,{key:0,severity:"error",size:"small",variant:"simple"},{default:n(()=>[e("ul",J,[(o(!0),i(p,null,z(l.password.errors,(c,m)=>(o(),i("li",{key:m},u(c.message),1))),128))])]),_:2},1024)):P("",!0)]),e("div",K,[r(g,{variant:"on"},{default:n(()=>[r(v,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:""}),e("label",O,u(s.$t("confirmPassword")),1)]),_:1}),(b=l.confirm_password)!=null&&b.invalid?(o(),M(x,{key:0,severity:"error",size:"small",variant:"simple"},{default:n(()=>[e("ul",Q,[(o(!0),i(p,null,z(l.confirm_password.errors,(c,m)=>(o(),i("li",{key:m},u(c.message),1))),128))])]),_:2},1024)):P("",!0)]),r(w,{type:"submit",label:"Save",loading:t.value,disabled:t.value},null,8,["loading","disabled"])]}),_:1},8,["initialValues","resolver"])])],64)}}});export{ns as default};
