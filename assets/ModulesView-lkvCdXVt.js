import{d as F,X as Y,a as U,Y as q,r as b,o as e,f as v,w as H,e as a,j as c,c as o,t as C,_ as M,h as f,g as G,b as I,V as T,k as O,s as X,H as J,a0 as K,u as Q,p as W,m as Z,P as ee,F as $,i as B,N as te}from"./index-B1qzSbqU.js";import{s as oe}from"./index-34mlyMdO.js";import{_ as se}from"./AHeader.vue_vue_type_script_setup_true_lang-vocd4uds.js";import{a as le}from"./logo-D7QKMmTn.js";import{a as R,t as L}from"./types-D01W8CP3.js";import{P as re}from"./pibody-BwAjMvHk.js";import{u as ae}from"./editor-store-Be6vTnLB.js";import{u as ne,m as ie}from"./useSortable-DqKiMqV1.js";import"./LocaleSwitcher.vue_vue_type_script_setup_true_lang-BN1uK4xK.js";import"./index-DRc2wfif.js";import"./index-gPr4JOzM.js";import"./index-DtVj8-Rp.js";import"./StudentViewToggle.vue_vue_type_script_setup_true_lang-DrzihNlS.js";import"./index-6ND4y4Nu.js";import"./index-MLev86Zg.js";import"./index-DFRUVbKZ.js";const de={key:0,class:"absolute top-0 right-0 text-sm"},ue={key:0,class:"flex items-center gap-1 bg-yellow-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},ce={key:0,class:"bg-green-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},pe={key:1,class:"bg-purple-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},me={key:2,class:"bg-blue-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},fe={key:3,class:"bg-red-500 text-white w-full px-2 py-[1px] rounded-bl-xl rounded-tr-xl"},xe={class:"bg-blue-500 text-white w-full px-2 py-[1px] rounded-tl-xl rounded-br-xl"},ye={class:"w-32 h-32 overflow-clip rounded-xl"},ve={class:"flex flex-col justify-between items-center px-4 py-1"},_e={class:"pb-1 font-medium text-lg text-center line-clamp-2"},he={key:0,class:"flex"},z=F({__name:"ModuleCard",props:{module:{}},emits:["after-remove"],setup(j,{emit:w}){const k=O(),_=Y(),D=U(),{user:u}=q(D),m=b(!1),t=j,P=w;function n(){_.require({message:"Are you sure you want to Delete?",header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Delete",severity:"danger"},accept:()=>{h()}})}async function h(){m.value=!0;try{await R.deleteModuleByID(t.module.id),P("after-remove")}catch(p){console.log(p)}finally{m.value=!1}}function x(){k.push(`/module/${t.module.id}/edit`)}return(p,i)=>{const S=le,s=X,l=J("RouterLink");return e(),v(l,{to:m.value?"":`/module/${t.module.id}`},{default:H(()=>{var d,y,g,r,A,E,N;return[a("div",{class:M(["p-0 w-32 relative",((d=c(u))==null?void 0:d.user_type)=="editor"?"h-56":"h-40"])},[((y=c(u))==null?void 0:y.user_type)=="editor"?(e(),o("div",de,[["in_modify"].includes(t.module.stage)?(e(),o("div",ue,[i[0]||(i[0]=a("i",{class:"pi pi-clock",style:{"font-size":"12px"}},null,-1)),a("div",null,C(t.module.stage.replace(/_/g," ").replace(/^./,V=>V.toUpperCase())),1)])):["ready_for_publish","published"].includes(t.module.stage)?(e(),o("div",{key:1,class:M(["flex items-center gap-1 px-2 py-[1px] rounded-bl-xl rounded-tr-xl",t.module.stage=="published"?"bg-green-500 text-white":"bg-green-100 text-green-700"])},[i[1]||(i[1]=a("i",{class:"pi pi-check-circle",style:{"font-size":"12px"}},null,-1)),a("div",null,C(t.module.stage.split("_")[0].replace(/^./,V=>V.toUpperCase())),1)],2)):f("",!0)])):f("",!0),((g=c(u))==null?void 0:g.user_type)=="editor"?(e(),o("div",{key:1,class:M(["absolute left-0 text-sm",((r=c(u))==null?void 0:r.user_type)=="editor"?"bottom-24":"bottom-8"])},[t.module.access_type=="freemium"?(e(),o("div",ce,"Free")):t.module.access_type=="premium"?(e(),o("div",pe,"Premium")):t.module.access_type=="demo"?(e(),o("div",me,"Demo")):t.module.access_type=="hackaton"?(e(),o("div",fe,"Hackaton ")):f("",!0)],2)):f("",!0),((A=c(u))==null?void 0:A.user_type)=="editor"?(e(),o("div",{key:2,class:M(["absolute right-0 text-sm",((E=c(u))==null?void 0:E.user_type)=="editor"?"bottom-24":"bottom-8"])},[a("div",xe,[i[2]||(i[2]=G("By ")),a("span",null,C(p.module.created_by),1)])],2)):f("",!0),a("div",ye,[I(S,{alt:"user header",src:t.module.cover_image.length>0?t.module.cover_image:c(re),width:"128",height:"128",class:"animate-fadein animate-once animate-duration-1000 animate-ease-in-out"},null,8,["src"])]),a("div",ve,[a("div",_e,C(t.module.title),1),((N=c(u))==null?void 0:N.user_type)=="editor"?(e(),o("div",he,[I(s,{icon:t.module.is_editable?"pi pi-pen-to-square":"pi pi-eye",severity:"info",variant:"text",rounded:"","aria-label":"Edit",onClick:T(x,["prevent"])},null,8,["icon"]),t.module.is_editable?(e(),v(s,{key:0,icon:"pi pi-trash",severity:"danger",variant:"text",rounded:"","aria-label":"Remove",onClick:T(n,["prevent"]),disabled:m.value,loading:m.value},null,8,["disabled","loading"])):f("",!0)])):f("",!0)])],2)]}),_:1},8,["to"])}}}),ge={class:"flex flex-col min-h-screen bg-slate-50"},be={class:"border border-dashed rounded-xl border-green-400 overflow-hidden h-fit"},we={key:1,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-6"},Le=F({__name:"ModulesView",setup(j){const w=K("el"),k=Q(),{locale:_}=W(),D=O(),u=ae(),{addLesson:m}=u,t=U(),{user:P}=q(t),n=b([]),h=b(0),x=b(!1),p=b(!1);ne(w,n,{onUpdate:s=>{ie(n.value,s.oldIndex,s.newIndex,s),te(async()=>{const l=[];n.value.map(d=>{const y=parseInt(d.id,10);l.push(y)});try{await R.changeModulesOrder(l),k.add({severity:"success",summary:"Modules order saved!",life:2e3})}catch(d){k.add({severity:"error",summary:"Order set error!",detail:d,life:2e3})}})}});async function i(){if(!x.value){x.value=!0;try{const{data:s}=await R.getModules();x.value=!1,n.value=[],h.value=s.length;for(const l of s){const d=await L(l,_.value);n.value.push(d)}}catch(s){console.log(s)}finally{x.value=!1}}}Z(i),ee(_,i);async function S(){p.value=!0;try{const{data:s}=await R.createModule(),l=await L(s,_.value);m(l),D.push(`/module/${l.id}/edit`)}catch(s){console.log(s)}finally{p.value=!1}}return(s,l)=>{var g;const d=oe,y=X;return e(),o("div",ge,[I(se),((g=c(P))==null?void 0:g.user_type)=="editor"?(e(),o("div",{key:0,ref_key:"el",ref:w,class:"flex flex-wrap justify-center gap-8 px-4 sm:px-12 py-6"},[(e(!0),o($,null,B(n.value,r=>(e(),v(z,{key:r.id,module:r,onAfterRemove:i},null,8,["module"]))),128)),(e(!0),o($,null,B(h.value-n.value.length,r=>(e(),v(d,{key:r,width:"128px",height:"128px",class:"rounded-xl shadow-sm"}))),128)),a("div",be,[I(y,{variant:"text",style:{width:"128px",height:"128px"},class:"bg-green-50",onClick:S,loading:p.value,disabled:p.value},{icon:H(()=>l[0]||(l[0]=[a("i",{class:"pi pi-plus text-xl"},null,-1)])),_:1},8,["loading","disabled"])])],512)):(e(),o("div",we,[(e(!0),o($,null,B(n.value,r=>(e(),v(z,{key:r.id,module:r,onAfterRemove:i},null,8,["module"]))),128)),(e(!0),o($,null,B(h.value-n.value.length,r=>(e(),v(d,{key:r,width:"128px",height:"128px",class:"rounded-xl shadow-sm"}))),128))]))])}}});export{Le as default};
