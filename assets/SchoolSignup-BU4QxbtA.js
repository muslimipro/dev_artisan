import{$ as G,e as H,f as P,u as J,r,b as K,o as d,c as f,a as e,k as t,h as x,G as v,w as p,i as w,j as k,t as n,T as O,F as Q,n as X,l as Y,R as Z}from"./index-BXslawiU.js";import{s as ee}from"./index-UVfE29m3.js";import{h as se,z as C,s as ae}from"./index-DkBeW8WF.js";import{s as le}from"./index-BbHqUexW.js";import{s as te}from"./index-D-Li2oDx.js";import{s as ie}from"./index-D5RqcZfo.js";import{_ as oe}from"./LocaleSelectButton.vue_vue_type_script_setup_true_lang-DKeSLIQg.js";import{S as ne}from"./schoolApi-DHommu5t.js";import{L as re}from"./logo-D1-3uCnC.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C3n_x_8f.js";import"./index-CSI4_wiQ.js";import"./language-DYQF8nnT.js";const ce={checkActivation:ue};async function ue($){try{return await G.post("/v2/activation/check",null,{params:{code:$}})}catch(a){throw console.log(a),a}}const me={class:"h-screen bg-white flex flex-col overflow-hidden relative"},ve={class:"w-full h-full flex justify-center gap-6 max-w-[1440px] p-6 mx-auto"},pe={class:"hidden lg:flex flex-col w-full max-w-[684px] justify-between bg-primary rounded-2xl p-10"},ge={class:"flex items-center gap-2"},fe={class:"w-full max-w-[684px] mx-auto flex items-center justify-center relative overflow-hidden"},he={class:"flex gap-1"},ye={class:"text-heading-3-semibold mb-2"},_e={class:"text-body-large-regular mb-8"},be={key:0,class:"w-full"},xe={class:"text-body-medium-regular mb-1"},we={key:1},ke={class:"text-body-medium-regular mb-1"},Ce={class:"mb-6"},Se={class:"text-body-medium-regular mb-1"},$e={class:"mb-6"},Ae={class:"text-body-medium-regular mb-1"},Ie={class:"mb-6"},Ve={key:2},Te={class:"flex flex-col gap-1"},Be={class:"flex justify-center text-body-medium-regular"},je={class:"flex gap-2 justify-end"},Le=H({__name:"SchoolSignup",setup($){const{t:a}=P(),h=J(),D=X(),c=r(!1),A=r(!1),y=r(""),I=r(!1),u=r(!1);async function N(){c.value=!0;try{const{data:s}=await ce.checkActivation(y.value);A.value=s.is_valid,A.value?(h.add({severity:"success",summary:a("pages.login.codeIsValid"),life:2e3}),V()):h.add({severity:"error",summary:a("pages.login.codeIsInvalid"),life:2e3})}catch(s){h.add({severity:"error",summary:s,life:2e3})}finally{c.value=!1}}const o=r(0),_=K(()=>[{id:0,title:a("pages.login.enterActivationCode"),description:a("pages.login.weWillVerifyActivationCode")},{id:1,title:a("pages.login.enterSchoolInfo"),description:a("pages.login.pleaseProvideInfo")},{id:2,title:a("pages.login.registrationSuccess"),description:a("pages.login.weHaveSentLoginDetails")}]);function V(){o.value<_.value.length-1&&o.value++}const g=r(!1),R=r({name:"",address:"",email:""}),z=se(C.object({name:C.string().min(1,{message:a("pages.login.nameIsRequired")}).max(100,{message:a("pages.login.max100chars")}),address:C.string().min(1,{message:a("pages.login.addressIsRequired")}).max(100,{message:a("pages.login.max100chars")}),email:C.string().email({message:a("pages.settings.emailInvalid")}).min(1,{message:a("pages.login.emailIsRequired")}).max(100,{message:a("pages.login.max100chars")})})),F=async s=>{if(!g.value&&s.valid){g.value=!0;try{await ne.createSchoolByCode(y.value,s.states.name.value,s.states.address.value,s.states.email.value,I.value),V()}catch(l){l.status==409&&!u.value?u.value=!0:h.add({severity:"error",summary:l.response.data.error,life:3e3})}finally{g.value=!1}}},T=r(null);async function q(){var s;I.value=!0,u.value=!1,await((s=T.value)==null?void 0:s.submit())}return(s,l)=>{const E=ie,m=Y,b=te,S=le,M=ae,U=ee,W=Z;return d(),f(Q,null,[e("div",me,[e("div",ve,[e("div",pe,[e("div",ge,[t(E,{src:x(re),width:"40"},null,8,["src"]),l[5]||(l[5]=e("p",{class:"text-heading-2-bold text-black"},"Artisan",-1))]),l[6]||(l[6]=e("div",{class:"text-display-small-bold text-neutral900"},[v(" Building"),e("br"),e("span",{class:"text-white"},"creative"),e("br"),v(" learners who"),e("br"),v(" love to grow ")],-1))]),e("div",fe,[t(x(oe),{class:"absolute top-0 left-1/2 -translate-x-1/2"}),t(O,{name:"slide-fade",mode:"out-in",class:"w-full max-w-[540px] flex"},{default:p(()=>[(d(),f("div",{key:o.value,class:"w-full flex flex-col"},[e("div",he,[o.value>0&&o.value!=_.value.length-1?(d(),w(m,{key:0,icon:"pi pi-chevron-left",class:"h-6 w-6",severity:"secondary",variant:"text",onClick:l[0]||(l[0]=i=>o.value--)})):k("",!0),e("div",ye,n(_.value[o.value].title),1)]),e("div",_e,n(_.value[o.value].description),1),o.value===0?(d(),f("div",be,[e("div",xe,n(s.$t("pages.login.activationCode")),1),t(b,{modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=i=>y.value=i),type:"text",fluid:"",class:"mb-6"},null,8,["modelValue"]),t(m,{label:s.$t("pages.login.continue"),class:"w-full h-12",onClick:N,loading:c.value,disabled:c.value},null,8,["label","loading","disabled"])])):o.value===1?(d(),f("div",we,[t(M,{ref_key:"form",ref:T,initialValues:R.value,resolver:x(z),onSubmit:F},{default:p(i=>{var B,j,L;return[e("div",ke,n(s.$t("pages.login.schoolName")),1),e("div",Ce,[t(b,{id:"name",name:"name",type:"text",fluid:""}),(B=i.name)!=null&&B.invalid?(d(),w(S,{key:0,severity:"error",size:"small",variant:"simple"},{default:p(()=>[v(n(i.name.error.message),1)]),_:2},1024)):k("",!0)]),e("div",Se,n(s.$t("pages.login.schoolAddress")),1),e("div",$e,[t(b,{id:"address",name:"address",type:"text",fluid:""}),(j=i.address)!=null&&j.invalid?(d(),w(S,{key:0,severity:"error",size:"small",variant:"simple"},{default:p(()=>[v(n(i.address.error.message),1)]),_:2},1024)):k("",!0)]),e("div",Ae,n(s.$t("pages.login.schoolEmail")),1),e("div",Ie,[t(b,{id:"email",name:"email",type:"text",fluid:""}),(L=i.email)!=null&&L.invalid?(d(),w(S,{key:0,severity:"error",size:"small",variant:"simple"},{default:p(()=>[v(n(i.email.error.message),1)]),_:2},1024)):k("",!0)]),t(m,{label:s.$t("pages.login.registerSchool"),type:"submit",class:"w-full h-12",loading:g.value,disabled:g.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])])):(d(),f("div",Ve,[t(m,{label:s.$t("pages.login.goToLogin"),class:"w-full h-12",onClick:l[2]||(l[2]=i=>x(D).replace({name:"login"})),loading:c.value,disabled:c.value},null,8,["label","loading","disabled"])]))]))]),_:1})])])]),t(W,{visible:u.value,"onUpdate:visible":l[4]||(l[4]=i=>u.value=i),modal:"",header:s.$t("accountTypeChange"),class:"m-4 max-w-md"},{default:p(()=>[e("div",Te,[e("div",Be,n(s.$t("thisAccountAlreadyExistsAndWillBeChangedToSchoolManager")),1)]),t(U),e("div",je,[t(m,{label:s.$t("pages.teacher.cancel"),severity:"secondary",onClick:l[3]||(l[3]=i=>u.value=!1)},null,8,["label"]),t(m,{label:s.$t("continue"),type:"submit",onClick:q},null,8,["label"])])]),_:1},8,["visible","header"])],64)}}}),Je=de(Le,[["__scopeId","data-v-3349af66"]]);export{Je as default};
