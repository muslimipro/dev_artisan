import{s as N}from"./index-DpYX8S_8.js";import{e as P,u as V,g as F,s as I,r as e,C as R,o as p,c as j,k as s,w as u,i as g,j as y,h as a,a as D,F as L,K as T,n as U,l as A}from"./index-RQaPKU3q.js";import{s as E}from"./index-BQKo0YUX.js";import{_ as K,a as M}from"./ExportProgressDialog.vue_vue_type_script_setup_true_lang-skygbjRE.js";import{_ as O}from"./SchoolInfo.vue_vue_type_script_setup_true_lang-B3M_uAtJ.js";import{S as h}from"./schoolApi-Ju9ppD7U.js";import{m as q}from"./mapClassFromDto-38Qo0hDD.js";import"./index-CY8HVpGr.js";import"./index-Rzgfwlcn.js";import"./index-BJXW17cL.js";import"./index-DP6Jkdyj.js";import"./index-BctX0Pow.js";import"./index-CBvRvFRr.js";import"./index-DoQeMzHI.js";import"./index-DZ_1xp5G.js";import"./index-CdWRCESg.js";import"./index-CJfAG3aM.js";import"./index-5bVhi2nm.js";import"./index-Cvpkor55.js";import"./index-vGkf9gTg.js";import"./index-6V6lXQ4K.js";import"./index-3r_oBTLo.js";import"./index-DYe12pIs.js";import"./index-CqyLZxbP.js";import"./index-C7IwSJ15.js";import"./xlsx-DjuO7_Ju.js";import"./routeApi-D5A-EIDQ.js";import"./mapRouteFromDto-JZc1Tx66.js";import"./mapLessonFromDto-C2sH6sUU.js";import"./mapUnitFromDto-DRcH-Z8v.js";import"./transformUnitDtosToPages-BbPlv-Pt.js";import"./lessonType-DG-bLtoJ.js";import"./mapStudentFromDto-D4MSietx.js";import"./index-BEGyIpqi.js";import"./index-C2AgmY6i.js";const z={class:"flex gap-2"},Vo=P({__name:"SchoolOverviewPage",setup(G){const C=V(),d=T(),k=U(),x=F(),{userInfo:S}=I(x),i=e(!1),t=e(null);async function $(){try{i.value=!0;const{data:o}=await h.getSchoolById(Number(d.params.id));t.value=o}catch(o){console.log(o)}finally{i.value=!1}}const n=e([]),m=e(!1);async function w(){try{m.value=!0;const{data:o}=await h.getSchoolClassesById(Number(d.params.id));n.value=(o==null?void 0:o.map(q))??[]}catch(o){C.add({severity:"error",summary:o.response.data.error,life:2e3})}finally{m.value=!1}}R(()=>{$(),w()});const c=e(!1);return(o,r)=>{var v;const B=E,f=A,b=N;return p(),j(L,null,[s(b,{class:"flex-grow flex flex-col gap-2"},{default:u(()=>[i.value?(p(),g(B,{key:0,class:"flex justify-center"})):y("",!0),t.value?(p(),g(a(O),{key:1,school:t.value},null,8,["school"])):y("",!0),s(a(K),{classes:n.value,loading:m.value},{"header-extra":u(()=>[s(f,{label:o.$t("exportProgress"),icon:"pi pi-upload",severity:"info",variant:"outlined",class:"mr-2",onClick:r[0]||(r[0]=l=>c.value=!0)},null,8,["label"])]),actions:u(({row:l})=>[D("div",z,[s(f,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:H=>{var _;return a(k).push({name:["super_admin","admin-viewer"].includes(((_=a(S))==null?void 0:_.user_type)??"")?"admin-class":"supervisor-class",params:{id:l.id}})}},null,8,["onClick"])])]),_:1},8,["classes","loading"])]),_:1}),s(a(M),{"model-value":c.value,"onUpdate:modelValue":r[1]||(r[1]=l=>c.value=l),classes:n.value,"school-name":((v=t.value)==null?void 0:v.title_en)??""},null,8,["model-value","classes","school-name"])],64)}}});export{Vo as default};
