import{e as q,a4 as A,P as M,ah as j,B as H,o as f,c as T,a,I as F,k as c,v as G,j as R,s as J,r as d,ai as O,a5 as Q,C as Z,D as ee,i as W,h as s,L as P,y as X,w as _,t as Y,l as te}from"./index-BXslawiU.js";import{s as oe}from"./index-Dz5hNrnF.js";import{q as se,u as le,a as ne,e as V,s as ae,_ as ie}from"./IdeButtons.vue_vue_type_script_setup_true_lang-Cf3a_6oe.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as re}from"./store-BrpL4K3A.js";import{u as de,B as ue}from"./CodeViewModal.vue_vue_type_style_index_0_scoped_818a8834_lang-BQWyHFCc.js";const pe=q({__name:"TerminalModal",props:A({id:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const U=u,i=M(u,"modelValue"),n=j({x:100,y:100});H(i,p=>{p&&(n.x=100,n.y=100)});const l=p=>{const r=p.clientX-n.x,o=p.clientY-n.y,k=v=>{n.x=v.clientX-r,n.y=v.clientY-o},y=()=>{document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",k),document.addEventListener("mouseup",y)};return(p,r)=>i.value?(f(),T("div",{key:0,class:"terminal-modal",style:G({left:n.x+"px",top:n.y+"px"}),onMousedown:l},[a("button",{class:"terminal-close-btn",onClick:r[0]||(r[0]=F(o=>i.value=!1,["stop"]))},r[1]||(r[1]=[a("span",{class:"material-icons"},"close",-1)])),c(se,{class:"terminal-content",id:U.id},null,8,["id"])],36)):R("",!0)}}),me=K(pe,[["__scopeId","data-v-fd5d4b9e"]]),ce={class:"relative w-full h-full flex flex-col"},ve={key:0,class:"absolute bottom-9 right-24 z-10"},fe={class:"flex gap-1"},ye={class:"absolute flex flex-row top-4 right-4 z-10"},be={key:0,class:"flex flex-row"},ge={class:"material-icons"},we={class:"material-icons"},ke=q({__name:"BlocklyViewer",props:A({id:{},blocksType:{},emulatorRun:{type:Boolean}},{code:{default:""},codeModifiers:{},state:{default:{}},stateModifiers:{},connectbuttons:{type:Boolean,default:!0},connectbuttonsModifiers:{}}),emits:A(["run","stop"],["update:code","update:state","update:connectbuttons"]),setup(u,{emit:U}){const i=M(u,"code"),n=M(u,"state"),l=u,p=M(u,"connectbuttons"),r=de(),{selectedKitType:o}=J(r),{setKitType:k}=r,y=d("main.py"),v=le(l.id);let x=d(!1),b=d(!1),S=d(!1),C=d(!1),g=null;if(l.emulatorRun){const w=re(l.id),e=ne(l.id);V.registerSimulation(l.id,{terminal:v,display:e,pibody:w}),g=V.getSharedEmulator();const m=O(g);x=m.isLoading,b=m.isRunning,S=m.isStopping,C=m.isConnected,C.value||g.connect()}const D=U;async function I(){!g||x.value||S.value||(C.value?await V.run(l.id,String(i.value)):g.connect(),D("run"))}async function N(){await V.stop(),D("stop")}async function h(){b.value?await N():await I()}const B=d(!1),L=d(!1),$=d(),E=()=>{if(!$.value)return;const w=$.value.$el;L.value=w.clientWidth<800};return Q(()=>{k(l.blocksType??"pibody")}),Z(async()=>{E(),window.addEventListener("resize",E)}),ee(()=>{window.removeEventListener("resize",E)}),(w,e)=>{const m=oe,z=te;return f(),T("div",ce,[(f(),W(ue,{ref_key:"blocklyComp",ref:$,class:"flex-grow",id:l.id,key:l.id,state:n.value,"onUpdate:state":e[0]||(e[0]=t=>n.value=t),code:i.value,"onUpdate:code":e[1]||(e[1]=t=>i.value=t),type:s(o),"onUpdate:type":e[2]||(e[2]=t=>P(o)?o.value=t:null),"auto-close":L.value,"onUpdate:autoClose":e[3]||(e[3]=t=>L.value=t),onRun:I},null,8,["id","state","code","type","auto-close"])),l.blocksType==null?(f(),T("div",ve,[a("div",fe,[a("div",{class:X(["flex border rounded-lg px-3 py-1 items-center gap-2 cursor-pointer",s(o)==="pibody"?"border-primary bg-white":"border-transparent bg-neutral50"]),onClick:e[5]||(e[5]=t=>o.value="pibody")},[e[12]||(e[12]=a("div",{class:"text-heading-5-semibold"},"Pibody",-1)),c(m,{modelValue:s(o),"onUpdate:modelValue":e[4]||(e[4]=t=>P(o)?o.value=t:null),name:"Pibody",value:"pibody"},null,8,["modelValue"])],2),a("div",{class:X(["flex border rounded-lg px-3 py-1 items-center gap-2 cursor-pointer",s(o)==="atlas"?"border-primary bg-white":"border-transparent bg-neutral50"]),onClick:e[7]||(e[7]=t=>o.value="atlas")},[e[13]||(e[13]=a("div",{class:"text-heading-5-semibold"},"Atlas",-1)),c(m,{modelValue:s(o),"onUpdate:modelValue":e[6]||(e[6]=t=>P(o)?o.value=t:null),name:"Atlas",value:"atlas"},null,8,["modelValue"])],2)])])):R("",!0),a("div",ye,[l.emulatorRun&&!s(ae)?(f(),T("div",be,[c(z,{id:"#run",type:"button",class:"w-9 h-9 mr-1",severity:"info",rounded:"",onClick:h,disabled:s(x)||s(b)},{default:_(()=>[a("span",ge,Y(s(x)?"hourglass_top":"play_arrow"),1)]),_:1},8,["disabled"]),c(z,{type:"button",class:"w-9 h-9 mr-1",variant:s(b)?void 0:"outlined",severity:"danger",rounded:"",onClick:N,disabled:!s(b)||!s(C)},{default:_(()=>[a("span",we,Y(s(S)?"hourglass_top":"stop"),1)]),_:1},8,["variant","disabled"])])):R("",!0),p.value?(f(),W(ie,{key:1,code:i.value,"onUpdate:code":e[8]||(e[8]=t=>i.value=t),"file-path":y.value,"onUpdate:filePath":e[9]||(e[9]=t=>y.value=t),"show-bluetooth":!0,onTerminalWrite:s(v).write,onTerminalClear:s(v).clear},null,8,["code","file-path","onTerminalWrite","onTerminalClear"])):R("",!0),c(z,{type:"button",class:"w-9 h-9 mr-1 bg-gray-400",rounded:"",onClick:e[10]||(e[10]=t=>B.value=!B.value)},{default:_(()=>e[14]||(e[14]=[a("span",null,"ðŸ“Ÿ",-1)])),_:1})]),c(s(me),{modelValue:B.value,"onUpdate:modelValue":e[11]||(e[11]=t=>B.value=t),id:w.id},null,8,["modelValue","id"])])}}}),Re=K(ke,[["__scopeId","data-v-0cb03e27"]]);export{Re as B};
