import{s as j}from"./index-CBVf1GB0.js";import{d as D,u as N,r as x,c as y,a as w,b as m,k as b,w as C,h as f,t as B,g as i,p as F,q as S,s as T,e as g,F as L,j as q,f as n,v as A,o as K}from"./index-BatFYxel.js";import{_ as M}from"./MainHeader.vue_vue_type_script_setup_true_lang-BZ7ouIBo.js";import{R as $,m as P}from"./mapRouteFromDto-xs2b4HON.js";import{g as U,f as h}from"./groupRoutesByType-B8LQ_TR7.js";import{s as E}from"./index-DIx-fEHn.js";import"./index-BZMWDKrg.js";import"./index-Db6KP036.js";import"./index-C_mupEx_.js";import"./http-Djzp07-Y.js";import"./mapLessonFromDto-BxEkOMg4.js";import"./mapUnitFromDto-BXFFFlEW.js";const V=D("routes-store",()=>{const t=N(),e=x([]),r=x(!1),s=x(!1);async function u(){try{r.value=!0;const{data:l}=await $.getRoutes();e.value=(l==null?void 0:l.map(P))??[]}catch(l){t.add({severity:"error",summary:l,life:2e3})}finally{r.value=!1}}async function a(l){try{s.value=!0;const{data:_}=await $.createRoute(l);await u(),t.add({severity:"success",summary:_.message,life:2e3})}catch(_){t.add({severity:"error",summary:_.response.data.error,life:2e3})}finally{s.value=!1}}const c=y(()=>U(e.value)),v=y(()=>h(e.value,"main")),k=y(()=>h(e.value,"side")),o=y(()=>h(e.value,"one_kit")),p=y(()=>h(e.value,"hackathon"));return{routes:e,isLoading:r,isCreating:s,loadRoutes:u,createRoute:a,groupedRoutes:c,mainRoutes:v,sideRoutes:k,oneKitRoutes:o,hackathonRoutes:p}}),G={class:"flex flex-col items-center"},H={class:"text-md font-medium text-gray-600"},I=w({__name:"RouteCard",props:{route:{}},setup(t){const e=F();return(r,s)=>{const u=S;return m(),b(u,{class:"p-4 border rounded-md bg-white shadow-sm w-40 h-24",variant:"outlined",severity:"secondary",onClick:s[0]||(s[0]=a=>i(e).push({name:"route-edit",params:{id:t.route.id}}))},{default:C(()=>[f("div",G,[f("div",H,B(t.route.name),1)])]),_:1})}}}),O={class:"flex flex-col gap-2"},z={class:"text-lg font-semibold"},J={class:"flex flex-wrap gap-2"},Q={class:"flex justify-end gap-2"},R=w({__name:"RouteGroup",props:{title:{},type:{},routes:{}},setup(t){const e=t,r=V(),{isCreating:s}=T(r),{createRoute:u}=r,a=x(!1),c=x("");async function v(){await u({name:c.value,description:"",route_type:e.type}),a.value=!1}return(k,o)=>{const p=S,l=E,_=A;return m(),g("div",O,[f("div",z,B(t.title),1),f("div",J,[(m(!0),g(L,null,q(t.routes,d=>(m(),b(I,{key:d.id,route:d},null,8,["route"]))),128)),n(p,{icon:"pi pi-plus",label:"Add",variant:"outlined",class:"w-40 h-24",onClick:o[0]||(o[0]=d=>{a.value=!0,c.value=""})}),n(_,{visible:a.value,"onUpdate:visible":o[3]||(o[3]=d=>a.value=d),modal:"",header:"Create new level",style:{width:"25rem"}},{default:C(()=>[n(l,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=d=>c.value=d),id:"name",class:"w-full mb-4",autocomplete:"off",placeholder:"Name"},null,8,["modelValue"]),f("div",Q,[n(p,{type:"button",label:"Cancel",severity:"secondary",onClick:o[2]||(o[2]=d=>a.value=!1)}),n(p,{type:"button",label:"Create",loading:i(s),disabled:i(s),onClick:v},null,8,["loading","disabled"])])]),_:1},8,["visible"])])])}}}),W={class:"flex flex-col items-center h-screen"},X={class:"w-full h-full max-w-screen-xl px-4 md:px-28 py-8"},Y={key:1,class:"flex flex-col gap-8 py-8"},Z={class:"flex gap-8"},pe=w({__name:"RoutesPage",setup(t){const e=V(),{isLoading:r,mainRoutes:s,sideRoutes:u,oneKitRoutes:a,hackathonRoutes:c}=T(e),{loadRoutes:v}=e;return K(v),(k,o)=>{const p=j;return m(),g("div",W,[n(i(M)),f("div",X,[i(r)?(m(),b(p,{key:0,class:"flex justify-center"})):(m(),g("div",Y,[f("div",Z,[n(R,{class:"flex-1",title:"Main",type:"main",routes:i(s)},null,8,["routes"]),n(R,{class:"flex-1",title:"Side quests",type:"side",routes:i(u)},null,8,["routes"])]),n(R,{title:"One project - one kit",type:"one_kit",routes:i(a)},null,8,["routes"]),n(R,{title:"Hackathon",type:"hackathon",routes:i(c)},null,8,["routes"])]))])])}}});export{pe as default};
