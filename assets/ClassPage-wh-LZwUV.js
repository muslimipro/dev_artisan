import{o,c as g,a,e as F,f as E,u as G,a6 as J,g as K,s as O,r as d,h as l,i as f,w as v,t as y,k as i,G as Q,j as w,U as W,l as X,R as Y}from"./index-BXslawiU.js";import{h as e1,z as I,s as s1}from"./index-DkBeW8WF.js";import{s as l1}from"./index-BbHqUexW.js";import{s as a1}from"./index-D-Li2oDx.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{C as U}from"./classApi-Dx0dhPAM.js";const t1={},o1={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function n1($,s){return o(),g("svg",o1,s[0]||(s[0]=[a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.25001 6C7.25001 3.37665 9.37666 1.25 12 1.25C14.6234 1.25 16.75 3.37665 16.75 6C16.75 8.62335 14.6234 10.75 12 10.75C9.37666 10.75 7.25001 8.62335 7.25001 6ZM12 2.75C10.2051 2.75 8.75001 4.20507 8.75001 6C8.75001 7.79493 10.2051 9.25 12 9.25C13.7949 9.25 15.25 7.79493 15.25 6C15.25 4.20507 13.7949 2.75 12 2.75Z",fill:"currentColor"},null,-1),a("path",{d:"M18 13.9167C18.4142 13.9167 18.75 14.2524 18.75 14.6667V15.25H19.3332C19.7474 15.25 20.0832 15.5858 20.0832 16C20.0832 16.4142 19.7474 16.75 19.3332 16.75H18.75V17.3333C18.75 17.7475 18.4142 18.0833 18 18.0833C17.5858 18.0833 17.25 17.7475 17.25 17.3333V16.75H16.6665C16.2523 16.75 15.9165 16.4142 15.9165 16C15.9165 15.5858 16.2523 15.25 16.6665 15.25H17.25V14.6667C17.25 14.2524 17.5858 13.9167 18 13.9167Z",fill:"currentColor"},null,-1),a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.7747 12.5129C13.9019 12.3421 12.9685 12.25 12 12.25C9.68646 12.25 7.55494 12.7759 5.97546 13.6643C4.41949 14.5396 3.25001 15.8661 3.25001 17.5L3.24995 17.602C3.24882 18.7638 3.2474 20.222 4.52642 21.2635C5.15589 21.7761 6.03649 22.1406 7.22622 22.3815C8.41927 22.6229 9.97424 22.75 12 22.75C14.8681 22.75 16.8099 22.4961 18.1196 22.0085C19.2985 21.5697 19.9973 20.9266 20.3704 20.1172C21.7927 19.2966 22.75 17.7601 22.75 16C22.75 13.3766 20.6234 11.25 18 11.25C16.7549 11.25 15.6217 11.7291 14.7747 12.5129ZM6.71085 14.9717C5.37139 15.7251 4.75001 16.6487 4.75001 17.5C4.75001 18.8078 4.79033 19.544 5.4736 20.1004C5.84413 20.4022 6.46354 20.6967 7.5238 20.9113C8.58075 21.1252 10.0258 21.25 12 21.25C14.578 21.25 16.2401 21.0366 17.3108 20.7004C15.0141 20.3666 13.25 18.3893 13.25 16C13.25 15.2322 13.4322 14.5069 13.7557 13.865C13.194 13.79 12.6061 13.75 12 13.75C9.89529 13.75 8.02681 14.2315 6.71085 14.9717ZM14.75 16C14.75 14.2051 16.2051 12.75 18 12.75C19.7949 12.75 21.25 14.2051 21.25 16C21.25 17.7949 19.7949 19.25 18 19.25C16.2051 19.25 14.75 17.7949 14.75 16Z",fill:"currentColor"},null,-1)]))}const i1=B(t1,[["render",n1]]),r1={},d1={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function c1($,s){return o(),g("svg",d1,s[0]||(s[0]=[a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 1.25C9.37664 1.25 7.25 3.37665 7.25 6C7.25 8.62335 9.37664 10.75 12 10.75C14.6233 10.75 16.75 8.62335 16.75 6C16.75 3.37665 14.6233 1.25 12 1.25ZM8.75 6C8.75 4.20507 10.2051 2.75 12 2.75C13.7949 2.75 15.25 4.20507 15.25 6C15.25 7.79493 13.7949 9.25 12 9.25C10.2051 9.25 8.75 7.79493 8.75 6Z",fill:"currentColor"},null,-1),a("path",{d:"M17 15.25C16.5858 15.25 16.25 15.5858 16.25 16C16.25 16.4142 16.5858 16.75 17 16.75H19C19.4142 16.75 19.75 16.4142 19.75 16C19.75 15.5858 19.4142 15.25 19 15.25H17Z",fill:"currentColor"},null,-1),a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 12.25C12.9685 12.25 13.9019 12.3421 14.7746 12.5129C15.6217 11.7291 16.7549 11.25 18 11.25C20.6234 11.25 22.75 13.3766 22.75 16C22.75 17.7601 21.7927 19.2966 20.3703 20.1172C19.9973 20.9266 19.2985 21.5697 18.1196 22.0085C16.8099 22.4961 14.8681 22.75 12 22.75C9.97422 22.75 8.41926 22.6229 7.22621 22.3815C6.03647 22.1406 5.15588 21.7761 4.52641 21.2635C3.24738 20.222 3.2488 18.7638 3.24993 17.602L3.25 17.5C3.25 15.8661 4.41948 14.5396 5.97545 13.6643C7.55492 12.7759 9.68645 12.25 12 12.25ZM4.75 17.5C4.75 16.6487 5.37137 15.7251 6.71084 14.9717C8.02679 14.2315 9.89527 13.75 12 13.75C12.6061 13.75 13.194 13.79 13.7557 13.865C13.4322 14.5069 13.25 15.2322 13.25 16C13.25 18.3893 15.0141 20.3666 17.3108 20.7004C16.2401 21.0366 14.578 21.25 12 21.25C10.0258 21.25 8.58074 21.1252 7.52379 20.9113C6.46352 20.6967 5.84412 20.4022 5.47359 20.1004C4.79031 19.544 4.75 18.8078 4.75 17.5ZM18 12.75C16.2051 12.75 14.75 14.2051 14.75 16C14.75 17.7949 16.2051 19.25 18 19.25C19.7949 19.25 21.25 17.7949 21.25 16C21.25 14.2051 19.7949 12.75 18 12.75Z",fill:"currentColor"},null,-1)]))}const u1=B(r1,[["render",c1]]),C1={class:"p-6 bg-white rounded-2xl"},p1={key:0},f1={class:"text-heading-3-bold text-neutral900"},v1={class:"flex flex-col gap-6"},g1={class:"flex flex-col gap-1"},m1={class:"text-body-medium-regular text-neutral900"},h1={key:0,class:"flex flex-col gap-1"},_1={class:"text-body-medium-regular text-neutral900"},y1={class:"flex gap-6 items-center"},b1={class:"flex justify-between items-center mb-8"},x1={class:"flex justify-end gap-2"},Z1=F({__name:"ClassPage",setup($){var V;const{t:s}=E(),c=G(),H=J(),k=K(),{userInfo:n}=O(k),{loadUserInfo:L}=k,u=d(!1),b=d(!1),S=d({school:((V=n.value)==null?void 0:V.school_name)??""}),N=e1(I.object({school:I.string().min(1,{message:s("pages.login.nameIsRequired")}).max(100,{message:s("pages.login.max100chars")})})),P=async e=>{if(!(u.value||!e.valid)){u.value=!0;try{await W.updateUserInfo({school_name:e.states.school.value}),c.add({severity:"success",summary:s("pages.settings.successfullySaved"),life:2e3}),b.value=!1}catch(t){c.add({severity:"error",summary:t.response.data.error,life:3e3})}finally{u.value=!1}}},m=d(""),C=d(!1),h=d(!1);async function T(){if(m.value.length!=0){h.value=!0;try{const{data:e}=await U.joinClass(m.value);C.value=!1,window.location.reload(),c.add({severity:"success",summary:e.message,life:2e3})}catch(e){c.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{h.value=!1}}}const _=d(!1);function z(){H.require({message:s("pages.settings.confirmLeaveClass"),header:s("pages.settings.confirmation"),icon:"pi pi-exclamation-triangle",rejectProps:{label:s("pages.settings.cancel"),severity:"secondary",outlined:!0},acceptProps:{label:s("pages.settings.leave"),severity:"danger"},accept:()=>{D()}})}async function D(){_.value=!0;try{const{data:e}=await U.leaveClass();await L(),c.add({severity:"success",summary:e.message,life:2e3})}catch(e){c.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{_.value=!1}}return(e,t)=>{const x=a1,R=l1,p=X,q=s1,A=Y;return o(),g("div",C1,[l(n)?(o(),f(q,{key:1,initialValues:S.value,resolver:l(N),onSubmit:P,class:"flex flex-col gap-10"},{default:v(r=>{var M;return[a("div",f1,y(e.$t("pages.settings.class")),1),a("div",v1,[a("div",g1,[a("div",m1,y(e.$t("pages.settings.school")),1),i(x,{name:"school",type:"text",fluid:"",placeholder:e.$t("pages.settings.school"),onInput:t[0]||(t[0]=j=>{var Z;return b.value=j.target.value!==(((Z=l(n))==null?void 0:Z.school_name)??"")}),disabled:l(n).class_name!=null},null,8,["placeholder","disabled"]),(M=r.school)!=null&&M.invalid?(o(),f(R,{key:0,severity:"error",size:"small",variant:"simple"},{default:v(()=>[Q(y(r.school.error.message),1)]),_:2},1024)):w("",!0)]),l(n).user_type=="student"?(o(),g("div",h1,[a("div",_1,y(e.$t("pages.settings.class")),1),a("div",y1,[i(x,{value:l(n).class_name,type:"text",fluid:"",placeholder:e.$t("pages.settings.class"),class:"flex-1",disabled:""},null,8,["value","placeholder"]),l(n).class_name?(o(),f(p,{key:1,label:e.$t("pages.settings.leaveClass"),variant:"outlined",severity:"danger",class:"flex-1",onClick:z,loading:_.value,disabled:_.value},{icon:v(()=>[i(l(u1),{class:"w-6 h-6"})]),_:1},8,["label","loading","disabled"])):(o(),f(p,{key:0,label:e.$t("pages.settings.joinClass"),variant:"outlined",class:"flex-1",onClick:t[1]||(t[1]=j=>C.value=!0)},{icon:v(()=>[i(l(i1),{class:"w-6 h-6"})]),_:1},8,["label"]))])])):w("",!0)]),l(n).class_name==null?(o(),f(p,{key:0,type:"submit",label:e.$t("saveChanges"),size:"small",class:"w-fit self-end",disabled:u.value||!b.value,loading:u.value},null,8,["label","disabled","loading"])):w("",!0)]}),_:1},8,["initialValues","resolver"])):(o(),g("div",p1,"No user")),i(A,{visible:C.value,"onUpdate:visible":t[4]||(t[4]=r=>C.value=r),modal:"",header:l(s)("pages.settings.joinClassByCode"),closable:!1},{default:v(()=>[a("div",b1,[i(x,{type:"text",modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=r=>m.value=r),placeholder:l(s)("pages.settings.enterCode"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",x1,[i(p,{type:"button",label:l(s)("pages.settings.cancel"),severity:"secondary",onClick:t[3]||(t[3]=r=>C.value=!1)},null,8,["label"]),i(p,{type:"button",label:l(s)("pages.settings.join"),onClick:T,loading:h.value,disabled:h.value},null,8,["label","loading","disabled"])])]),_:1},8,["visible","header"])])}}});export{Z1 as default};
