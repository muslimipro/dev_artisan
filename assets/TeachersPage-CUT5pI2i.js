import{s as q,a as A}from"./index-BxVfWoVs.js";import{s as O}from"./index-CpduQ_ib.js";import{s as R,a as E}from"./index-U6bxdMDU.js";import{s as B}from"./index-D-Li2oDx.js";import{e as F,u as M,P as G,r as m,o as h,i as $,w as s,a as c,t as i,k as l,l as N,R as H,a6 as K,f as L,C as z,c as I,j as x,G as g,b2 as J}from"./index-BXslawiU.js";import{S as w}from"./schoolApi-DHommu5t.js";import{s as Q}from"./index-UVfE29m3.js";import"./index-nahM27qd.js";import"./index-CGa94giF.js";import"./index-CG2VAMzt.js";import"./index-3ruNB34S.js";import"./index-ChaYh2fZ.js";import"./index-DBVaFmK0.js";import"./index-eWDnl5yI.js";import"./index-DrihGHDg.js";import"./index-D71fjEBX.js";import"./index-Dt3kwrS5.js";import"./index-Dz5hNrnF.js";import"./index-DkoQadpT.js";const W={class:"flex flex-col gap-1"},X={class:"flex flex-col"},Y={class:"font-bold text-sm mb-1"},Z={class:"flex gap-2 justify-end"},ee=F({__name:"InviteTeacherDialog",props:{modelValue:{type:Boolean,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(k){const y=M(),p=G(k,"modelValue"),n=m(""),r=m(!1);async function v(){r.value=!0;try{const{data:t}=await w.inviteTeacher(n.value);window.location.reload(),y.add({severity:"success",summary:t.message,life:2e3}),p.value=!1}catch(t){y.add({severity:"error",summary:t.response.data.error,detail:t,life:2e3})}finally{r.value=!1}}return(t,d)=>{const u=B,C=Q,b=N,T=H;return h(),$(T,{visible:p.value,"onUpdate:visible":d[2]||(d[2]=f=>p.value=f),modal:"",draggable:!1,class:"m-4 max-w-md",header:t.$t("pages.school.inviteTeacher")},{default:s(()=>[c("div",W,[c("div",X,[c("div",Y,i(t.$t("pages.school.email")),1),l(u,{type:"text",modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=f=>n.value=f)},null,8,["modelValue"])]),l(C),c("div",Z,[l(b,{label:t.$t("pages.school.cancel"),severity:"secondary",onClick:d[1]||(d[1]=f=>p.value=!1)},null,8,["label"]),l(b,{label:t.$t("pages.school.invite"),onClick:v,loading:r.value,disabled:r.value},null,8,["label","loading","disabled"])])])]),_:1},8,["visible","header"])}}}),oe={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},ae={class:"flex items-center"},le={class:"flex-grow flex gap-2 items-center"},se={key:0,class:"text-2xl"},ke=F({__name:"TeachersPage",setup(k){const y=M(),p=K(),{t:n}=L(),r=m(!1),v=m([]),t=m(!1),d=m(),u=m();(()=>{u.value={global:{value:null,matchMode:J.CONTAINS}}})();async function b(){try{r.value=!0;const{data:e}=await w.getTeachers();v.value=e??[]}catch(e){console.log(e)}finally{r.value=!1}}z(b);function T(e){p.require({message:n("pages.school.confirmDelete"),header:n("pages.school.confirmHeader"),icon:"pi pi-exclamation-triangle",rejectProps:{label:n("pages.school.confirmCancel"),severity:"secondary",outlined:!0},acceptProps:{label:n("pages.school.confirmDeleteBtn"),severity:"danger"},accept:async()=>{f(e)}})}async function f(e){try{const{data:a}=await w.deleteTeacher(e);b(),y.add({severity:"success",summary:a.message,life:2e3})}catch(a){y.add({severity:"error",summary:a.response.data.error,detail:a,life:2e3})}}return(e,a)=>{const D=N,P=R,U=B,j=E,_=q,V=O,S=A;return h(),I("div",oe,[l(S,{ref_key:"dt",ref:d,filters:u.value,"onUpdate:filters":a[2]||(a[2]=o=>u.value=o),value:v.value,dataKey:"id",loading:r.value,scrollable:"",globalFilterFields:["name","email"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:s(()=>[c("div",ae,[c("div",le,[v.value?(h(),I("div",se,i(e.$t("pages.school.teachers"))+" - "+i(v.value.length),1)):x("",!0)]),l(D,{label:e.$t("pages.school.inviteTeacher"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:a[0]||(a[0]=o=>t.value=!0)},null,8,["label"]),l(j,null,{default:s(()=>[l(P,null,{default:s(()=>a[4]||(a[4]=[c("i",{class:"pi pi-search"},null,-1)])),_:1}),l(U,{modelValue:u.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=o=>u.value.global.value=o),placeholder:e.$t("pages.school.search")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:s(()=>[g(i(e.$t("pages.school.noTeachersFound")),1)]),loading:s(()=>[g(i(e.$t("pages.school.loadingTeachers")),1)]),default:s(()=>[l(_,{field:"email",header:e.$t("pages.school.email"),sortable:""},{body:s(({data:o})=>[g(i(o.email),1)]),_:1},8,["header"]),l(_,{field:"name",header:e.$t("pages.school.name"),sortable:""},{body:s(({data:o})=>[c("div",null,i(`${o.name}`),1)]),_:1},8,["header"]),l(_,{header:e.$t("pages.school.status"),sortable:""},{body:s(({data:o})=>[o.registered?o.registered&&!o.invited?(h(),$(V,{key:1,severity:"info"},{default:s(()=>[g(i(e.$t("pages.school.invited")),1)]),_:1})):o.registered&&o.invited?(h(),$(V,{key:2,severity:"success"},{default:s(()=>[g(i(e.$t("pages.school.joined")),1)]),_:1})):x("",!0):(h(),$(V,{key:0,severity:"danger"},{default:s(()=>[g(i(e.$t("pages.school.notRegistered")),1)]),_:1}))]),_:1},8,["header"]),l(_,{exportable:!1},{body:s(({data:o})=>[l(D,{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:te=>T(o.email)},null,8,["onClick"])]),_:1})]),_:1},8,["filters","value","loading"]),l(ee,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value=o)},null,8,["modelValue"])])}}});export{ke as default};
