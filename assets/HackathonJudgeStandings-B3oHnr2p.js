import{s as V,a as L}from"./index-BJXW17cL.js";import{e as P,u as O,r as c,a5 as U,C as G,D as K,b as q,o as r,c as f,a as s,i as B,j as H,k as u,w as a,G as J,t as n,h as k,F as X,q as Q,K as W,b2 as Y}from"./index-RQaPKU3q.js";import{C as Z,I as D}from"./CountdownTimerStandings-Dsa6xcTi.js";import{H as tt}from"./hackathonApi-D3ls0kX0.js";import"./index-DP6Jkdyj.js";import"./index-BctX0Pow.js";import"./index-CBvRvFRr.js";import"./index-DoQeMzHI.js";import"./index-DZ_1xp5G.js";import"./index-CdWRCESg.js";import"./index-CJfAG3aM.js";import"./index-5bVhi2nm.js";import"./index-Cvpkor55.js";import"./index-vGkf9gTg.js";import"./index-6V6lXQ4K.js";import"./index-CY8HVpGr.js";import"./index-3r_oBTLo.js";import"./index-Rzgfwlcn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-i87uic1r.js";import"./index-5bJt7VTk.js";import"./LocaleSelectButton.vue_vue_type_script_setup_true_lang-D5A7GxOk.js";import"./index-csPL02fk.js";import"./language-DYQF8nnT.js";import"./logo-D1-3uCnC.js";const et={class:"flex flex-col items-center h-screen"},st={class:"w-full max-w-[1280px] p-2 flex flex-col gap-2"},ot={class:"flex flex-col gap-2 bg-white rounded-2xl p-4 relative"},it={class:"w-full flex text-heading-4-semibold text-neutral800 justify-center"},nt={class:"pb-2 flex w-full justify-center"},lt={key:0,class:"relative flex justify-center"},at={class:"text-heading-4-semibold text-warning400"},rt={key:1,class:"relative flex justify-center"},dt={class:"text-heading-4-semibold text-neutral"},ct={key:2,class:"relative flex justify-center"},ft={class:"text-heading-4-semibold text-warning700"},ut={key:3,class:"text-heading-4-semibold flex justify-center"},mt={class:"flex text-heading-4-semibold text-neutral800"},pt={class:"flex flex-col justify-center"},_t={class:"text-heading-3-semibold text-neutral800"},xt={class:"text-body-medium-regular text-neutral"},ht={key:0,class:"flex gap-2 items-center"},vt={class:"text-overline-small text-primary400"},gt={key:1,class:"flex gap-2 items-center"},yt={class:"text-overline-small text-error400"},bt={class:"flex w-full justify-center"},wt={class:"text-center text-overline-small text-neutral800"},kt={class:"flex flex-col items-center leading-tight"},Dt={class:"font-medium"},Tt={class:"text-[10px] text-neutral400"},jt={class:"flex w-full justify-center"},Nt={class:"text-center text-heading-4-semibold text-neutral800"},Mt={class:"flex flex-col items-center leading-tight"},Ct={class:"flex justify-center font-bold"},Ft={class:"flex justify-center text-[10px] text-neutral500"},ie=P({__name:"HackathonJudgeStandings",setup(It){const S=O(),$=W(),T=c(!1),j=c(!1),h=c([]),N=c([]),M=c({}),v=c(null);async function C(){var l,i;T.value=!0;try{const{data:o}=await tt.getHackathonAllResultsById(Number($.params.id),j.value);o.name&&(v.value=o),o.lessons&&(h.value=o.lessons),o.students&&(N.value=o.students);const e={};for(const t of o.submits??[])e[t.team_id]||(e[t.team_id]={}),e[t.team_id][t.lesson_id]={points:t.points,created_at:t.created_at};M.value=e,j.value=!0}catch(o){S.add({severity:"error",summary:((i=(l=o.response)==null?void 0:l.data)==null?void 0:i.error)??"Error",detail:o.message,life:2e3})}finally{T.value=!1}}let g;U(C),G(()=>{g=window.setInterval(()=>{C()},15e3)}),K(()=>{g&&clearInterval(g)});const F={},x={},z=q(()=>{const i=N.value.map(e=>{var p;const t={id:e.id,name:e.name,school_name:e.school_name};let d=0,m=null;for(const b of h.value){const _=(p=M.value[e.id])==null?void 0:p[b.id],E=(_==null?void 0:_.points)??0;t[b.id]=E;const w=(_==null?void 0:_.created_at)??null;if(t[`${b.id}_time`]=w,d+=E,w){const R=new Date(w).getTime();m=m===null?R:Math.max(m,R)}}return t.total=d,t.totalTime=m??Number.MAX_SAFE_INTEGER,t.lastFrozenDiff=x[e.id]||0,t}).sort((e,t)=>t.total!==e.total?t.total-e.total:e.totalTime-t.totalTime),o={};return i.forEach((e,t)=>{const d=t+1,m=F[e.id],p=m!==void 0?m-d:0;e.position=d,p!==0?(e.positionDiff=p,o[e.id]=p):e.positionDiff=0,F[e.id]=d}),Object.keys(x).forEach(e=>delete x[Number(e)]),Object.assign(x,o),i}),I=l=>{if(l==null)return"";const i=new Date(l);return isNaN(i.getTime())?"":i.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",second:"2-digit"})},A=c(),y=c();return(()=>{y.value={global:{value:null,matchMode:Y.CONTAINS}}})(),(l,i)=>{const o=V,e=L;return r(),f("div",et,[s("div",st,[v.value?(r(),B(Z,{key:0,data:v.value},null,8,["data"])):H("",!0),s("div",ot,[u(e,{ref_key:"dt",ref:A,filters:y.value,"onUpdate:filters":i[0]||(i[0]=t=>y.value=t),value:z.value,dataKey:"id",scrollable:"",class:"rounded-md overflow-hidden w-full"},{empty:a(()=>i[1]||(i[1]=[J(n("No data"))])),default:a(()=>[u(o,{field:"position"},{header:a(()=>[s("div",it,n(l.$t("place")),1)]),body:a(({data:t})=>[s("div",nt,[t.position==1?(r(),f("div",lt,[s("div",at,n(t.position),1),u(k(D),{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] w-10 h-10 text-warning400"})])):t.position==2?(r(),f("div",rt,[s("div",dt,n(t.position),1),u(k(D),{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] w-10 h-10 text-neutral"})])):t.position==3?(r(),f("div",ct,[s("div",ft,n(t.position),1),u(k(D),{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] w-10 h-10 text-warning700"})])):(r(),f("div",ut,n(t.position),1))])]),_:1}),u(o,{field:"name"},{header:a(()=>[s("div",mt,n(l.$t("team")),1)]),body:a(({data:t})=>[s("div",pt,[s("div",_t,n(t.name),1),s("div",xt,n(t.school_name),1)])]),_:1}),u(o,{field:"positionDiff"},{body:a(({data:t})=>[t.positionDiff>0?(r(),f("div",ht,[i[2]||(i[2]=s("i",{class:"pi pi-arrow-up text-primary400",style:{"font-size":"1rem"}},null,-1)),s("div",vt,n(Math.abs(t.positionDiff)),1)])):t.positionDiff<0?(r(),f("div",gt,[i[3]||(i[3]=s("i",{class:"pi pi-arrow-down text-error400",style:{"font-size":"1rem"}},null,-1)),s("div",yt,n(Math.abs(t.positionDiff)),1)])):H("",!0)]),_:1}),(r(!0),f(X,null,Q(h.value,t=>(r(),B(o,{key:t.id},{header:a(()=>[s("div",bt,[s("div",wt,n(t.name),1)])]),body:a(({data:d})=>[s("div",kt,[s("div",Dt,n(d[t.id]),1),s("div",Tt,n(I(d[`${t.id}_time`])),1)])]),_:2},1024))),128)),u(o,{field:"total",frozen:!0,alignFrozen:"right",class:"bg-neutral100"},{header:a(()=>[s("div",jt,[s("div",Nt,n(l.$t("total")),1)])]),body:a(({data:t})=>[s("div",Mt,[s("div",Ct,n(t.total),1),s("div",Ft,n(I(t.totalTime)),1)])]),_:1})]),_:1},8,["filters","value"])])])])}}});export{ie as default};
