import{s as z}from"./index-Cc9LjYJC.js";import{h as C,o as N,s as w,a as T}from"./types-DM7f0bKm.js";import{a as j,u as q,r as M,b as e,k as p,w as r,f as o,h as a,t as l,e as i,j as g,F as v,l as h,g as A,q as L}from"./index-BatFYxel.js";import{s as D}from"./index-CXWJh2Nm.js";import{s as E}from"./index-BLtEdgdJ.js";import{s as O}from"./index-CkvQtMm-.js";import{S as Z}from"./index-BXwBh0Eq.js";import"./index-lpjeyZ2o.js";import"./index-DVER4fU-.js";import"./index-C_mupEx_.js";import"./index-DIx-fEHn.js";import"./http-Djzp07-Y.js";const G={class:"flex flex-col gap-1"},H={for:"old_password"},I={class:"my-0 flex flex-col gap-1"},J={class:"flex flex-col gap-1"},K={for:"new_password"},Q={class:"my-0 flex flex-col gap-1"},R={class:"flex flex-col gap-1"},U={for:"confirm_password"},W={class:"my-0 flex flex-col gap-1"},ms=j({__name:"ChangePassword",setup(X){const y=q(),n=M(!1),P=M({old_password:"",new_password:""}),V=C(N({old_password:w().min(1,{message:"Old password is required."}).max(100,{message:"Maximum 100 characters."}),new_password:w().min(8,{message:"Minimum 8 characters."}).max(100,{message:"Maximum 100 characters."}).refine(s=>/[a-z]/.test(s),{message:"Must have a lowercase letter."}).refine(s=>/[A-Z]/.test(s),{message:"Must have an uppercase letter."}).refine(s=>/[0-9]/.test(s),{message:"Must have a number."}),confirm_password:w()}).refine(s=>s.new_password===s.confirm_password,{message:"Passwords must match",path:["confirm_password"]})),B=async s=>{if(!n.value&&s.valid){n.value=!0;try{const{data:d}=await Z.changePassword(s.states.old_password.value,s.states.new_password.value);y.add({severity:"success",summary:d.message,life:2e3})}catch(d){y.add({severity:"error",summary:d.response.data.error,detail:d,life:2e3})}finally{n.value=!1}}};return(s,d)=>{const f=O,u=E,_=D,F=L,S=T,$=z;return e(),p($,{class:"flex-grow",header:s.$t("pages.settings.changePassword")},{default:r(()=>[o(S,{initialValues:P.value,resolver:A(V),onSubmit:B,class:"flex flex-col gap-2"},{default:r(t=>{var b,x,k;return[a("div",G,[o(u,{variant:"on"},{default:r(()=>[o(f,{id:"old_password",name:"old_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",H,l(s.$t("pages.settings.oldPassword")),1)]),_:1}),(b=t.old_password)!=null&&b.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",I,[(e(!0),i(v,null,g(t.old_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",J,[o(u,{variant:"on"},{default:r(()=>[o(f,{id:"new_password",name:"new_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",K,l(s.$t("pages.settings.newPassword")),1)]),_:1}),(x=t.new_password)!=null&&x.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",Q,[(e(!0),i(v,null,g(t.new_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),a("div",R,[o(u,{variant:"on"},{default:r(()=>[o(f,{id:"confirm_password",name:"confirm_password",feedback:!1,toggleMask:"",fluid:"",class:"w-full sm:w-96"}),a("label",U,l(s.$t("pages.settings.confirmPassword")),1)]),_:1}),(k=t.confirm_password)!=null&&k.invalid?(e(),p(_,{key:0,severity:"error",size:"small",variant:"simple"},{default:r(()=>[a("ul",W,[(e(!0),i(v,null,g(t.confirm_password.errors,(c,m)=>(e(),i("li",{key:m},l(c.message),1))),128))])]),_:2},1024)):h("",!0)]),o(F,{type:"submit",label:s.$t("pages.settings.savePassword"),class:"w-fit",loading:n.value,disabled:n.value},null,8,["label","loading","disabled"])]}),_:1},8,["initialValues","resolver"])]),_:1},8,["header"])}}});export{ms as default};
