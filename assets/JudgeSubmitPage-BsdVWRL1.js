import{s as M}from"./index-C5W94n6N.js";import{e as q,u as A,r as i,a5 as G,C as K,b as y,B as H,o as r,c as u,a as s,k as c,w as Q,h as I,G as W,t as j,F as X,q as Y,j as Z,K as ee,ag as te,l as ae}from"./index-8eYd0-Co.js";import{s as se}from"./index-DRGFISwW.js";import{s as le}from"./index-DQafit8Y.js";import{s as oe}from"./index-WXQmNEQQ.js";import{_ as ne}from"./MdViewer.vue_vue_type_style_index_0_lang-1aZPBoDA.js";import{m as ie}from"./mapUnitFromDto-C-vlLM9s.js";import{L as re}from"./logo-D1-3uCnC.js";import{H as b}from"./hackathonApi-DIfw8bCS.js";import"./index-ahqnJA0E.js";import"./index-B3NttIqY.js";import"./index-VgJXLjdG.js";import"./index-CQCkvxda.js";import"./index-eKsVto-V.js";import"./index-CsjCzc3Q.js";import"./index-B8MXaspB.js";const ue={class:"flex flex-col items-center h-screen"},ce={class:"flex items-center justify-center w-full min-h-[72px] border-b border-gray-200 bg-white sticky top-0 z-50"},de={class:"flex-grow flex items-center justify-between h-full max-w-[1280px] px-8"},me={class:"flex items-center"},ve={class:"text-xl px-2"},pe={class:"font-semibold"},fe={key:0,class:"mt-20"},_e={key:1,class:"mt-20"},he={key:2,class:"w-full max-w-[1280px] p-8 flex flex-col gap-4"},xe={class:"flex flex-col bg-white rounded-2xl gap-4 p-6"},ye={key:0,class:"text-heading-3-semibold"},be={key:1,class:"flex flex-col gap-4"},ge={class:"flex items-center justify-between"},ke={class:"text-heading-3-semibold h-6"},we={key:0,class:"flex flex-col gap-2"},Ne={class:"flex gap-4 items-center"},Ve={class:"min-w-fit"},je={class:"flex gap-4 w-full"},Me=q({__name:"JudgeSubmitPage",setup(Se){const _=ee(),h=A(),m=i(!1),g=i(null),a=i(null);let k;const d=i(0);async function P(){try{const{data:e}=await b.getHackathonStudentsById(Number(_.params.id));g.value=e??[]}catch(e){m.value=!1,h.add({severity:"error",summary:e.response.data.error,life:2e3})}}const w=i(null),l=i(null);async function R(){try{const{data:e}=await b.getHackathonLessonsById(Number(_.params.id));w.value=e?e.filter(t=>t.type==="project"):[]}catch(e){m.value=!1,h.add({severity:"error",summary:e.response.data.error,life:2e3})}}const S=i("");async function U(){const{data:e}=await b.getHackathonResultsById(Number(_.params.id),!1);e.name&&(S.value=e.name)}G(U),K(async()=>{m.value=!0,await P(),await R(),m.value=!1});const v=y(()=>l.value?ie(l.value.unit):null),o=i([]);H(l,()=>{o.value=[]});function $(e,t){a.value=null,d.value=0,t?o.value.includes(e)||o.value.push(e):o.value=o.value.filter(p=>p!==e)}function z(e){return o.value.includes(e)}function D(){o.value=[],a.value=null,d.value=0}const F=y(()=>{if(!v.value)return 0;const e=v.value.data;return o.value.reduce((t,p)=>{const f=e.checks.find(N=>N.id===p);return t+((f==null?void 0:f.xp)??0)},0)}),O=y(()=>l.value&&a.value),x=i(!1);async function T(){if(!(l.value==null||a.value==null)){x.value=!0;try{await b.submitHackathonResultById(Number(_.params.id),{lesson_id:l.value.id,points:F.value,team_id:a.value.id}),a.value=null,o.value=[],h.add({severity:"success",summary:"Submitted successfully",life:2e3})}catch(e){h.add({severity:"error",summary:e.response.data.error,life:2e3})}finally{x.value=!1}}}H(a,()=>{clearInterval(k),a.value!=null&&(d.value=5,k=window.setInterval(()=>{d.value--,d.value==0&&(a.value=null,clearInterval(k))},1e3))});const E=y(()=>"Submit"+(d.value>0?" ("+d.value+"s)":""));return(e,t)=>{const p=oe,f=te("RouterLink"),N=le,B=se,C=ae,J=M;return r(),u("div",ue,[s("div",ce,[s("div",de,[s("div",me,[c(f,{to:"/v2",class:"flex items-center hover:opacity-80 transition"},{default:Q(()=>[c(p,{src:I(re),width:"40",class:"mr-2"},null,8,["src"]),s("p",ve,[t[2]||(t[2]=W("Judge submission - ")),s("span",pe,j(S.value),1)])]),_:1})])])]),m.value?(r(),u("div",fe,[c(N)])):!g.value||!w.value?(r(),u("div",_e,"No data")):(r(),u("div",he,[c(B,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=n=>l.value=n),options:w.value,"option-label":"name",placeholder:"Select project"},null,8,["modelValue","options"]),s("div",xe,[l.value==null?(r(),u("div",ye,"No project")):(r(),u("div",be,[s("div",ge,[s("div",ke,j(l.value.name),1),c(C,{icon:"pi pi-replay",size:"small",severity:"secondary",onClick:D})]),v.value?(r(),u("div",we,[(r(!0),u(X,null,Y(v.value.content.options,n=>{var L;return r(),u("div",{key:n.id,class:"flex gap-4 items-center justify-between"},[s("div",Ne,[c(J,{"model-value":z(n.id),binary:!0,"onUpdate:modelValue":V=>$(n.id,V)},null,8,["model-value","onUpdate:modelValue"]),c(I(ne),{text:n.text},null,8,["text"])]),s("div",Ve,"+ "+j((L=v.value.data.checks.find(V=>V.id===n.id))==null?void 0:L.xp)+" pt ",1)])}),128))])):Z("",!0)]))]),s("div",je,[c(B,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=n=>a.value=n),options:g.value,"option-label":"name",placeholder:"Select team",class:"flex-1"},null,8,["modelValue","options"]),c(C,{label:E.value,size:"small",class:"flex-1",onClick:T,disabled:!O.value||x.value,loading:x.value},null,8,["label","disabled","loading"])])]))])}}});export{Me as default};
