import{e as x,a4 as M,P,u as B,r as c,B as E,o as y,i as $,w as h,a as f,t as I,k as o,l as D,R,g as S,s as T,C as N,c as j,h as v,n as q}from"./index-RQaPKU3q.js";import{_ as A,a as F}from"./ExportProgressDialog.vue_vue_type_script_setup_true_lang-skygbjRE.js";import{C as k,m as L}from"./mapClassFromDto-38Qo0hDD.js";import{s as z}from"./index-DYe12pIs.js";import{s as G}from"./index-DoQeMzHI.js";import"./index-BJXW17cL.js";import"./index-DP6Jkdyj.js";import"./index-BctX0Pow.js";import"./index-CBvRvFRr.js";import"./index-DZ_1xp5G.js";import"./index-CdWRCESg.js";import"./index-CJfAG3aM.js";import"./index-5bVhi2nm.js";import"./index-Cvpkor55.js";import"./index-vGkf9gTg.js";import"./index-6V6lXQ4K.js";import"./index-CY8HVpGr.js";import"./index-3r_oBTLo.js";import"./index-Rzgfwlcn.js";import"./index-CqyLZxbP.js";import"./index-C7IwSJ15.js";import"./xlsx-DjuO7_Ju.js";import"./routeApi-D5A-EIDQ.js";import"./mapRouteFromDto-JZc1Tx66.js";import"./mapLessonFromDto-C2sH6sUU.js";import"./mapUnitFromDto-DRcH-Z8v.js";import"./transformUnitDtosToPages-BbPlv-Pt.js";import"./lessonType-DG-bLtoJ.js";import"./mapStudentFromDto-D4MSietx.js";const H={class:"flex flex-col gap-1"},J={class:"flex flex-col"},K={class:"font-bold text-sm mb-1"},O={class:"flex gap-2 justify-end"},Q=x({__name:"EditClassDialog",props:M({selectedClass:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const d=P(b,"modelValue"),u=b,m=B(),i=c(""),a=c(!1);E(()=>u.selectedClass,e=>{i.value="",e&&(i.value=e.name)},{immediate:!0});async function g(){a.value=!0;try{const{data:e}=await k.createClass(i.value);window.location.reload(),m.add({severity:"success",summary:e.message,life:2e3}),d.value=!1}catch(e){m.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{a.value=!1}}async function C(){if(u.selectedClass){a.value=!0;try{const{data:e}=await k.updateClassById(u.selectedClass.id,i.value);window.location.reload(),m.add({severity:"success",summary:e.message,life:2e3}),d.value=!1}catch(e){m.add({severity:"error",summary:e.response.data.error,detail:e,life:2e3})}finally{a.value=!1}}}return(e,l)=>{const _=G,p=z,s=D,t=R;return y(),$(t,{visible:d.value,"onUpdate:visible":l[2]||(l[2]=r=>d.value=r),modal:"",draggable:!1,class:"m-4 max-w-md",header:u.selectedClass?e.$t("pages.teacher.editClass"):e.$t("pages.teacher.addClass")},{default:h(()=>[f("div",H,[f("div",J,[f("div",K,I(e.$t("pages.teacher.name")),1),o(_,{type:"text",modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=r=>i.value=r)},null,8,["modelValue"])]),o(p),f("div",O,[o(s,{label:e.$t("pages.teacher.cancel"),severity:"secondary",onClick:l[1]||(l[1]=r=>d.value=!1)},null,8,["label"]),u.selectedClass==null?(y(),$(s,{key:0,label:e.$t("pages.teacher.create"),onClick:g,loading:a.value,disabled:a.value},null,8,["label","loading","disabled"])):(y(),$(s,{key:1,label:e.$t("pages.teacher.save"),onClick:C,loading:a.value,disabled:a.value},null,8,["label","loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),W={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},X={class:"flex gap-2"},Be=x({__name:"ClassesPage",setup(b){const d=B(),u=q(),m=S(),{userInfo:i}=T(m),a=c(!1),g=c(null);function C(s){a.value=!0,g.value=s}const e=c([]),l=c(!1);async function _(){try{l.value=!0;const{data:s}=await k.getClasses();e.value=(s==null?void 0:s.map(L))??[]}catch(s){d.add({severity:"error",summary:s.response.data.error,life:2e3})}finally{l.value=!1}}N(()=>{_()});const p=c(!1);return(s,t)=>{var w;const r=D;return y(),j("div",W,[o(v(A),{classes:e.value,loading:l.value},{"header-extra":h(()=>[o(r,{label:s.$t("pages.teacher.addClass"),icon:"pi pi-plus",variant:"outlined",class:"mr-2",onClick:t[0]||(t[0]=n=>C(null))},null,8,["label"]),o(r,{label:s.$t("exportProgress"),icon:"pi pi-upload",severity:"info",variant:"outlined",class:"mr-2",onClick:t[1]||(t[1]=n=>p.value=!0)},null,8,["label"])]),actions:h(({row:n})=>[f("div",X,[o(r,{icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:U=>C(n)},null,8,["onClick"]),o(r,{icon:"pi pi-angle-right",outlined:"",rounded:"",severity:"info",onClick:U=>{var V;return v(u).push({name:((V=v(i))==null?void 0:V.user_type)=="teacher"?"teacher-class":"school-class",params:{id:n.id}})}},null,8,["onClick"])])]),_:1},8,["classes","loading"]),o(Q,{"model-value":a.value,"onUpdate:modelValue":t[2]||(t[2]=n=>a.value=n),"selected-class":g.value},null,8,["model-value","selected-class"]),o(v(F),{"model-value":p.value,"onUpdate:modelValue":t[3]||(t[3]=n=>p.value=n),classes:e.value,"school-name":((w=v(i))==null?void 0:w.school_name)??""},null,8,["model-value","classes","school-name"])])}}});export{Be as default};
