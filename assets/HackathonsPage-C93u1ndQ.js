import{s as E,a as R}from"./index-D24MRCgv.js";import{s as L,a as j}from"./index-CQCkvxda.js";import{s as M}from"./index-B3NttIqY.js";import{e as P,a4 as O,u as S,P as q,r as n,B as G,o as h,i as C,w as d,a as t,k as l,l as A,R as K,g as J,s as Q,C as W,c as H,t as b,j as B,h as I,G as T,F as X,b2 as Y}from"./index-8eYd0-Co.js";import{H as N}from"./hackathonApi-DIfw8bCS.js";import{s as Z}from"./index-c_rbGUP2.js";import{s as ee}from"./index-B50-4SOK.js";import"./index-DRGFISwW.js";import"./index-VgJXLjdG.js";import"./index-eKsVto-V.js";import"./index-CsjCzc3Q.js";import"./index-DW8h8G0I.js";import"./index-BB-HFA2F.js";import"./index-CSTKEaPu.js";import"./index-Drl6JR_B.js";import"./index-C5W94n6N.js";import"./index-ahqnJA0E.js";import"./index-H-9SRDzX.js";import"./index-fKBIE13H.js";import"./index-VaRh2XWh.js";const ae={class:"flex flex-col gap-1"},te={class:"flex flex-col gap-2"},le={class:"flex flex-row gap-2"},se={class:"flex flex-col flex-1"},oe={class:"flex flex-col flex-1"},de={class:"flex flex-row gap-2"},ne={class:"flex flex-col"},ie={class:"flex gap-2 items-center"},re={class:"flex flex-col"},ue={class:"flex gap-2 items-center"},me={class:"flex flex-row gap-2"},ve={class:"flex flex-col"},ce={class:"flex gap-2 items-center"},fe={class:"flex flex-col"},_e={class:"flex gap-2 items-center"},pe={class:"flex gap-2 justify-end"},be=P({__name:"EditHackathonDialog",props:O({selectedHackathon:{}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(F){const y=S(),g=q(F,"modelValue"),u=F,x=n(),f=n(),v=n(),c=n(),_=n(),m=n(),i=n();G(()=>u.selectedHackathon,a=>{x.value="",f.value=void 0,v.value=void 0,c.value=void 0,_.value=void 0,m.value=void 0,i.value=void 0,a&&(x.value=a.name,f.value=a.route_id,v.value=a.class_id,c.value=new Date(a.starts_at),_.value=new Date(a.ends_at),m.value=a.start_freeze_at==null?null:new Date(a.start_freeze_at),i.value=a.end_freeze_at==null?null:new Date(a.end_freeze_at))},{immediate:!0});const r=n(!1);async function U(){r.value=!0;try{const{data:a}=await N.createHackathon({name:x.value,route_id:Number(f.value),class_id:Number(v.value),starts_at:c.value,ends_at:_.value,start_freeze_at:m.value==null?void 0:m.value,end_freeze_at:i.value==null?void 0:i.value});y.add({severity:"success",summary:a.message,life:2e3}),window.location.reload(),g.value=!1}catch(a){y.add({severity:"error",summary:a.response.data.error,detail:a,life:2e3})}finally{r.value=!1}}async function k(){if(u.selectedHackathon!=null){r.value=!0;try{const{data:a}=await N.updateHackathon(u.selectedHackathon.id,{name:x.value,route_id:f.value==null?void 0:Number(f.value),class_id:v.value==null?void 0:Number(v.value),starts_at:c.value,ends_at:_.value,start_freeze_at:m.value==null?void 0:m.value,end_freeze_at:i.value==null?void 0:i.value});y.add({severity:"success",summary:a.message,life:2e3}),window.location.reload(),g.value=!1}catch(a){y.add({severity:"error",summary:a.response.data.error,detail:a,life:2e3})}finally{r.value=!1}}}return(a,e)=>{const V=M,w=ee,D=Z,$=A,p=K;return h(),C(p,{visible:g.value,"onUpdate:visible":e[8]||(e[8]=o=>g.value=o),modal:"",draggable:!1,class:"m-4 max-w-md",header:u.selectedHackathon?"Edit hackathon":"Add hackathon"},{default:d(()=>[t("div",ae,[t("div",te,[e[9]||(e[9]=t("div",{class:"font-bold text-sm"},"Hackathon name",-1)),l(V,{key:"name",type:"text",modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=o=>x.value=o)},null,8,["modelValue"])]),t("div",le,[t("div",se,[e[10]||(e[10]=t("div",{class:"font-bold text-sm"},"Route id",-1)),l(V,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=o=>f.value=o),class:"w-full"},null,8,["modelValue"])]),t("div",oe,[e[11]||(e[11]=t("div",{class:"font-bold text-sm"},"Class id",-1)),l(V,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),class:"w-full"},null,8,["modelValue"])])]),t("div",de,[t("div",ne,[e[12]||(e[12]=t("div",{class:"font-bold text-sm mb-1"},"starts_at",-1)),t("div",ie,[l(w,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),showTime:"",hourFormat:"24"},null,8,["modelValue"])])]),t("div",re,[e[13]||(e[13]=t("div",{class:"font-bold text-sm mb-1"},"ends_at",-1)),t("div",ue,[l(w,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=o=>_.value=o),showTime:"",hourFormat:"24"},null,8,["modelValue"])])])]),l(D),t("div",me,[t("div",ve,[e[14]||(e[14]=t("div",{class:"font-bold text-sm mb-1"},"start_freeze_at",-1)),t("div",ce,[l(w,{modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=o=>m.value=o),showTime:"",hourFormat:"24",showButtonBar:""},null,8,["modelValue"])])]),t("div",fe,[e[15]||(e[15]=t("div",{class:"font-bold text-sm mb-1"},"end_freeze_at",-1)),t("div",_e,[l(w,{modelValue:i.value,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value=o),showTime:"",hourFormat:"24",showButtonBar:""},null,8,["modelValue"])])])]),l(D),t("div",pe,[l($,{label:"Cancel",severity:"secondary",onClick:e[7]||(e[7]=o=>g.value=!1)}),u.selectedHackathon==null?(h(),C($,{key:0,label:"Create",onClick:U,loading:r.value,disabled:r.value},null,8,["loading","disabled"])):(h(),C($,{key:1,label:"Save",onClick:k,loading:r.value,disabled:r.value},null,8,["loading","disabled"]))])])]),_:1},8,["visible","header"])}}}),ge={class:"flex-grow min-w-0 pb-4 mb-4 bg-white rounded-md border"},xe={class:"flex items-center"},he={class:"flex-grow flex gap-2 items-center"},ye={key:0,class:"text-2xl"},ke={class:"w-44"},Ve={class:"w-44"},we={class:"w-44"},$e={class:"w-44"},ze={class:"flex gap-2"},Je=P({__name:"HackathonsPage",setup(F){const y=S(),g=n(),u=n();(()=>{u.value={global:{value:null,matchMode:Y.CONTAINS}}})();const f=J(),{userInfo:v}=Q(f),c=n(!1),_=n(null);function m(a){c.value=!0,_.value=a}const i=n([]),r=n(!1);async function U(){try{r.value=!0;const{data:a}=await N.getHackathons();i.value=a??[]}catch(a){y.add({severity:"error",summary:a.response.data.error,life:2e3})}finally{r.value=!1}}W(()=>{U()});function k(a){return a==null?"":new Date(a).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}return(a,e)=>{const V=A,w=L,D=M,$=j,p=E,o=R;return h(),H(X,null,[t("div",ge,[l(o,{ref_key:"dt",ref:g,filters:u.value,"onUpdate:filters":e[2]||(e[2]=s=>u.value=s),value:i.value,dataKey:"id",loading:r.value,scrollable:"",globalFilterFields:["id","name","created_at"],class:"rounded-md overflow-hidden w-full",paginator:"",rows:10,rowsPerPageOptions:[5,10,25]},{header:d(()=>{var s;return[t("div",xe,[t("div",he,[i.value?(h(),H("div",ye,b(a.$t("hackathons"))+" - "+b(i.value.length),1)):B("",!0)]),((s=I(v))==null?void 0:s.user_type)=="super_admin"?(h(),C(V,{key:0,label:"Add",icon:"pi pi-plus",severity:"success",variant:"outlined",class:"mr-2",onClick:e[0]||(e[0]=z=>m(null))})):B("",!0),l($,null,{default:d(()=>[l(w,null,{default:d(()=>e[4]||(e[4]=[t("i",{class:"pi pi-search"},null,-1)])),_:1}),l(D,{modelValue:u.value.global.value,"onUpdate:modelValue":e[1]||(e[1]=z=>u.value.global.value=z),placeholder:a.$t("pages.teacher.search")},null,8,["modelValue","placeholder"])]),_:1})])]}),empty:d(()=>e[5]||(e[5]=[T(" No hackathons found. ")])),loading:d(()=>e[6]||(e[6]=[T(" Loading hackathons data. Please wait. ")])),default:d(()=>[l(p,{field:"id",header:"ID",sortable:""},{body:d(({data:s})=>[T(b(s.id),1)]),_:1}),l(p,{field:"name",header:a.$t("name"),sortable:""},{body:d(({data:s})=>[t("div",null,b(`${s.name}`),1)]),_:1},8,["header"]),l(p,{field:"starts_at",header:"starts_at",sortable:""},{body:d(({data:s})=>[t("div",ke,b(k(s.starts_at)),1)]),_:1}),l(p,{field:"start_freeze_at",header:"start_freeze_at",sortable:""},{body:d(({data:s})=>[t("div",Ve,b(k(s.start_freeze_at)),1)]),_:1}),l(p,{field:"ends_at",header:"ends_at",sortable:""},{body:d(({data:s})=>[t("div",we,b(k(s.ends_at)),1)]),_:1}),l(p,{field:"end_freeze_at",header:"end_freeze_at",sortable:""},{body:d(({data:s})=>[t("div",$e,b(k(s.end_freeze_at)),1)]),_:1}),l(p,{frozen:!0,alignFrozen:"right"},{body:d(({data:s})=>{var z;return[t("div",ze,[((z=I(v))==null?void 0:z.user_type)=="super_admin"?(h(),C(V,{key:0,icon:"pi pi-pencil",outlined:"",rounded:"",severity:"warn",onClick:Ce=>m(s)},null,8,["onClick"])):B("",!0)])]}),_:1})]),_:1},8,["filters","value","loading"])]),l(be,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),"selected-hackathon":_.value},null,8,["modelValue","selected-hackathon"])],64)}}});export{Je as default};
